<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Polynomials and transformations</title>
    <meta charset="utf-8" />
    <meta name="author" content="Merlin Schaeffer  Department of Sociology" />
    <meta name="date" content="2025-11-26" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="../template/Merlin169.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Polynomials and transformations
]
.subtitle[
## Modeling non-linear relationships
]
.author[
### Merlin Schaeffer<br> Department of Sociology
]
.date[
### 2025-11-26
]

---


# Goal of empirical sociology

.font130[.center[Use data to .alert[discover patterns], &lt;br&gt; and the social mechanisms that bring them about.]]

&lt;img src="https://researchleap.com/wp-content/uploads/2021/12/Population-data.jpeg" width="70%" style="display: block; margin: auto;" /&gt;

---
class: inverse middle
# Today's schedule

Application of the day: Life expectancy at birth!
1. Recap: Interaction terms.
2. LOESS (locally estimated scatterplot smoothing)
3. Polynomials
  + Polynomials as interaction terms
  + Higher order polynomials
4. Data transformations
  + `\(\log_2\)`

---
layout: true
class: inverse 
# Life expectancy at birth

.push-left[
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/The_newborn_baby_in_men.jpg/1920px-The_newborn_baby_in_men.jpg" width="65%" style="display: block; margin: auto;" /&gt;&lt;img src="https://ychef.files.bbci.co.uk/976x549/p086k2k4.jpg" width="65%" style="display: block; margin: auto;" /&gt;
]

---

.push-right[
&lt;iframe src="https://ourworldindata.org/grapher/life-expectancy?tab=chart&amp;time=1770..2019&amp;country=Africa~Asia~Europe~OWID_WRL~Americas~Oceania" loading="lazy" style="width: 100%; height: 500px; border: 0px none;"&gt;&lt;/iframe&gt;
]

---

.push-right[
&lt;iframe src="https://ourworldindata.org/grapher/life-expectancy-unwpp?tab=chart&amp;country=Europe+%28UN%29~Africa+%28UN%29~Asia+%28UN%29~Oceania+%28UN%29~Northern+America+%28UN%29~Latin+America+and+the+Caribbean+%28UN%29" loading="lazy" style="width: 100%; height: 500px; border: 0px none;" allow="web-share; clipboard-write"&gt;&lt;/iframe&gt;
]
---
layout: false
class: inverse 
# Is life expectacy simply a (linear) function of&lt;br&gt; how much money we spend on health?

&lt;iframe src="https://ourworldindata.org/grapher/total-healthcare-expenditure-gdp" loading="lazy" style="width: 90%; height: 450px; border: 0px none;"&gt;&lt;/iframe&gt;

---
# Preparations

.panelset[
.panel[.panel-name[Woldbank health data]

``` r
pacman::p_load(
  tidyverse, # Data manipulation,
  ggplot2, # beautiful figures,
  wbstats, # download data from Worldbank. Tremendous source of global socio-economic data.
  estimatr, # OLS with robust SE
  modelsummary, # regression tables with nice layout,
  directlabels, # Labels addded to ggplot2 lines,
  rockchalk, # 3d plots of interaction effects,
  vdemdata) # Use varieties of democracy data

Dat_life &lt;- wb_data(
  # Download Life expectancy and healthcare expenditures data.
* c("SP.DYN.LE00.IN", "SH.XPD.CHEX.PP.CD"),
  start_date = 2000, end_date = 2025) %&gt;%
* rename(LifeExpect = SP.DYN.LE00.IN, # rename health variables,
*        HealthExp = SH.XPD.CHEX.PP.CD,
         year = date, # rename year variable,
         country_text_id = iso3c) %&gt;%
  select(country_text_id, country, year, LifeExpect, HealthExp) %&gt;% # Keep only 4 variables
  drop_na(LifeExpect, HealthExp) # Drop cases with missing data
```
]
.panel[.panel-name[Join citizenship rights]

``` r
Dat_vdem &lt;- vdem %&gt;% # The data are part of the package we loaded earlier
   as_tibble() %&gt;% # turn into a tiblle
   select(country_name, country_text_id, year, v2xcl_rol) %&gt;%
   rename(equal_liberty = v2xcl_rol) # rename liberty variable

# Join Worldbank Health and Citizenship rights data
Dat &lt;- inner_join(Dat_life, Dat_vdem, by = c("country_text_id", "year"))
```
]
.panel[.panel-name[Add socialism]
.font60[

``` r
Dat &lt;- Dat %&gt;% mutate(
  socialist = case_when( # Years socialist minus years since not socialist anymore,
    country == "China" ~ year - 1949,
    country == "Viet Nam" ~ year - 1945,
    country == "Algeria" ~ year - 1962,
    str_detect(country,"Portugal|Bangladesh") ~ year - 1972,
    country == "Guinea-Bissau" ~ year - 1973, country == "India" ~ year - 1976, 
    country == "Nicaragua" ~ year - 1979, country == "Sri Lanka" ~ year - 1978,
    country == "Tanzania" ~ year - 1964, country == "Albania" ~ (1992 - 1944) - (year - 1992),
    str_detect(country, "Angola|Cabo Verde|Madagascar") ~ (1992 - 1975) - (year - 1992),
    str_detect(country,"Belarus|Bulgaria") ~ (1990 - 1946) - (year - 1990),
    str_detect(country, "Benin|Mozambique") ~ (1990 - 1975) - (year - 1990),
    country == "Chad" ~ (1975 - 1962) - (year - 1975), country == "Congo, Rep." ~ (1992 - 1970) - (year - 1992),
    country == "Czech Republic" ~ (1990 - 1948) - (year - 1990), country == "Djibouti" ~ (1992 - 1981) - (year - 1992),
    country == "Ethiopia" ~ (1991 - 1974) - (year - 1991), country == "Ghana" ~ (1966 - 1960) - (year - 1966),
    country == "Guinea" ~ (1984 - 1958) - (year - 1984), country == "Hungary" ~ (1989 - 1949) - (year - 1989),
    country == "Iraq" ~ (2005 - 1958) - (year - 2005), country == "Mali" ~ (1991 - 1960) - (year - 1991),
    country == "Mauritania" ~ (1978 - 1961) - (year - 1978), country == "Mongolia" ~ (1992 - 1924) - (year - 1992),
    country == "Myanmar" ~ (1988 - 1962) - (year - 1988), country == "Poland" ~ (1989 - 1945) - (year - 1989),
    country == "Romania" ~ (1989 - 1947) - (year - 1989), country == "Russian Federation" ~ (1991 - 1922) - (year - 1991),
    country == "Seychelles" ~ (1991 - 1977) - (year - 1991), country == "Senegal" ~ (1981 - 1960) - (year - 1981),
    country == "Sierra Leone" ~ (1991 - 1978) - (year - 1991), country == "Somalia" ~ (1991 - 1969) - (year - 1991),
    country == "Sudan" ~ (1985 - 1969) - (year - 1985), country == "Syria" ~ (2012 - 1963) - (year - 2012),
    country == "Tunisia" ~ (1988 - 1964) - (year - 1988), country == "Ukraine" ~ (1991 - 1919) - (year - 1991),
    country == "Yemen, Rep." ~ (1991 - 1967) - (year - 1991), country == "Zambia" ~ (1991 - 1973) - (year - 1991),
    str_detect(country,"Slovenia|Croatia|Serbia|Montenegro|Bosnia and Herzegovina|North Macedonia|Kosovo") ~ (1992 - 1943) - (year - 1992),
    TRUE ~ 0),
  socialist = case_when( # Min. 5 years given any socialist history,
    socialist != 0 &amp; socialist &lt; 5 ~ 5,
    TRUE ~ socialist)) %&gt;% drop_na() # Drop countries with missing values.
```
]]
.panel[.panel-name[The resulting data]

``` r
Dat
# # A tibble: 3,897 × 8
#    country_text_id country      year LifeExpect HealthExp country_name equal_liberty socialist
#    &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;
#  1 AFG             Afghanistan  2002       56.2      85.9 Afghanistan          0.38          0
#  2 AFG             Afghanistan  2003       57.2      85.9 Afghanistan          0.377         0
#  3 AFG             Afghanistan  2004       57.8      93.9 Afghanistan          0.377         0
#  4 AFG             Afghanistan  2005       58.2     106.  Afghanistan          0.379         0
#  5 AFG             Afghanistan  2006       58.6     118.  Afghanistan          0.379         0
#  6 AFG             Afghanistan  2007       59.0     112.  Afghanistan          0.379         0
#  7 AFG             Afghanistan  2008       59.7     137.  Afghanistan          0.379         0
#  8 AFG             Afghanistan  2009       60.2     153.  Afghanistan          0.381         0
#  9 AFG             Afghanistan  2010       60.7     148.  Afghanistan          0.388         0
# 10 AFG             Afghanistan  2011       61.2     147.  Afghanistan          0.394         0
# # ℹ 3,887 more rows
```
]]

---
class: clear
# Development of life expectancy at birth

.panelset[
.panel[.panel-name[Some country trends]
&lt;img src="12-Polys_files/figure-html/LifeExp1-1.png" width="55%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Code]

``` r
ggplot(data = Dat %&gt;%  # Start of the ggplot function, specifying the data to be used
         # Filter the data to include only these four countries
         filter(country == "Denmark" | country == "Switzerland" | country == "Germany" | country == "Sweden"),  
       # Define the aesthetics: LifeExpect on y-axis, HealthExp on x-axis, color by country
       aes(y = LifeExpect, x = HealthExp, color = country)) +  
  geom_line(alpha = 0.5) +  # Add lines to the plot with a transparency of 0.5
  # Add text labels to the plot, using the 'date' column for labels, with a size of 2.3
  geom_text(aes(label = year), size = 2.3) +  
  guides(color = FALSE) +  # Remove the legend for color
  scale_x_continuous(expand=c(0, 1300)) +  # Adjust the x-axis scale, adding 1300 units of space to the right 
  # Add direct labels to the lines, placing them at the last points of each line
  geom_dl(aes(label = country), method = list(dl.combine("last.points"))) + 
  labs(y = "Life expectacy at birth",  # Set the y-axis label
       x = "Health expenditure per capita in $") +  # Set the x-axis label
  theme_minimal()  # Use a minimal theme for the plot
```
]]

---
class: inverse center middle

# Recap: Interaction effects

---
# Recap: Interaction effects

.push-left[
.font80[

``` r
ols_1 &lt;- lm_robust(
  LifeExpect ~ socialist*equal_liberty, data = Dat,
* clusters = country) # Note that we need to specify this argument,
*# because the observations are not independent!
*# They are repeated observations of the same countries.

# 3D plot of interaction. Controls set to their mean.
plotPlane(ols_1, "equal_liberty", "socialist", theta = 35, phi = 20)
```

&lt;img src="12-Polys_files/figure-html/unnamed-chunk-5-1.png" width="50%" style="display: block; margin: auto;" /&gt;

``` r
modelsummary(list("Life Exp." = ols_1),
             gof_map = c("nobs", "r.squared"), 
             stars = TRUE, output = "gt")
```
]]

.push-right[
.font80[
<div id="ncaouvoauw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ncaouvoauw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ncaouvoauw thead, #ncaouvoauw tbody, #ncaouvoauw tfoot, #ncaouvoauw tr, #ncaouvoauw td, #ncaouvoauw th {
  border-style: none;
}

#ncaouvoauw p {
  margin: 0;
  padding: 0;
}

#ncaouvoauw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ncaouvoauw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ncaouvoauw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ncaouvoauw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ncaouvoauw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ncaouvoauw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncaouvoauw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ncaouvoauw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ncaouvoauw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ncaouvoauw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ncaouvoauw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ncaouvoauw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ncaouvoauw .gt_spanner_row {
  border-bottom-style: hidden;
}

#ncaouvoauw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ncaouvoauw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ncaouvoauw .gt_from_md > :first-child {
  margin-top: 0;
}

#ncaouvoauw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ncaouvoauw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ncaouvoauw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ncaouvoauw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ncaouvoauw .gt_row_group_first td {
  border-top-width: 2px;
}

#ncaouvoauw .gt_row_group_first th {
  border-top-width: 2px;
}

#ncaouvoauw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncaouvoauw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ncaouvoauw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ncaouvoauw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncaouvoauw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncaouvoauw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ncaouvoauw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ncaouvoauw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ncaouvoauw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncaouvoauw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ncaouvoauw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncaouvoauw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ncaouvoauw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncaouvoauw .gt_left {
  text-align: left;
}

#ncaouvoauw .gt_center {
  text-align: center;
}

#ncaouvoauw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ncaouvoauw .gt_font_normal {
  font-weight: normal;
}

#ncaouvoauw .gt_font_bold {
  font-weight: bold;
}

#ncaouvoauw .gt_font_italic {
  font-style: italic;
}

#ncaouvoauw .gt_super {
  font-size: 65%;
}

#ncaouvoauw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ncaouvoauw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ncaouvoauw .gt_indent_1 {
  text-indent: 5px;
}

#ncaouvoauw .gt_indent_2 {
  text-indent: 10px;
}

#ncaouvoauw .gt_indent_3 {
  text-indent: 15px;
}

#ncaouvoauw .gt_indent_4 {
  text-indent: 20px;
}

#ncaouvoauw .gt_indent_5 {
  text-indent: 25px;
}

#ncaouvoauw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ncaouvoauw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">58.592***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.892)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.181*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.091)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">16.313***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(2.440)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.233+</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.136)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.205</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

---
class: inverse center middle

# The problem: Non-linear relationships

---
# Health expenditures

.push-left[
.font80[

<div id="bqqmzuerhd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bqqmzuerhd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bqqmzuerhd thead, #bqqmzuerhd tbody, #bqqmzuerhd tfoot, #bqqmzuerhd tr, #bqqmzuerhd td, #bqqmzuerhd th {
  border-style: none;
}

#bqqmzuerhd p {
  margin: 0;
  padding: 0;
}

#bqqmzuerhd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bqqmzuerhd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bqqmzuerhd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bqqmzuerhd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bqqmzuerhd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqqmzuerhd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqqmzuerhd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqqmzuerhd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bqqmzuerhd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bqqmzuerhd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bqqmzuerhd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bqqmzuerhd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bqqmzuerhd .gt_spanner_row {
  border-bottom-style: hidden;
}

#bqqmzuerhd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bqqmzuerhd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bqqmzuerhd .gt_from_md > :first-child {
  margin-top: 0;
}

#bqqmzuerhd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bqqmzuerhd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bqqmzuerhd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqmzuerhd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bqqmzuerhd .gt_row_group_first td {
  border-top-width: 2px;
}

#bqqmzuerhd .gt_row_group_first th {
  border-top-width: 2px;
}

#bqqmzuerhd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqmzuerhd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bqqmzuerhd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bqqmzuerhd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqqmzuerhd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqmzuerhd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bqqmzuerhd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bqqmzuerhd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bqqmzuerhd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqqmzuerhd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqqmzuerhd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqmzuerhd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqqmzuerhd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqmzuerhd .gt_left {
  text-align: left;
}

#bqqmzuerhd .gt_center {
  text-align: center;
}

#bqqmzuerhd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bqqmzuerhd .gt_font_normal {
  font-weight: normal;
}

#bqqmzuerhd .gt_font_bold {
  font-weight: bold;
}

#bqqmzuerhd .gt_font_italic {
  font-style: italic;
}

#bqqmzuerhd .gt_super {
  font-size: 65%;
}

#bqqmzuerhd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bqqmzuerhd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bqqmzuerhd .gt_indent_1 {
  text-indent: 5px;
}

#bqqmzuerhd .gt_indent_2 {
  text-indent: 10px;
}

#bqqmzuerhd .gt_indent_3 {
  text-indent: 15px;
}

#bqqmzuerhd .gt_indent_4 {
  text-indent: 20px;
}

#bqqmzuerhd .gt_indent_5 {
  text-indent: 25px;
}

#bqqmzuerhd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bqqmzuerhd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">-124.471*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(55.845)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">I(HealthExp/1000)</td>
<td headers="Life Exp." class="gt_row gt_center">3.110***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.445)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">year</td>
<td headers="Life Exp." class="gt_row gt_center">0.092***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.028)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.118</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.075)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">6.584**</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(2.302)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.062</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.107)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.472</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

--

.push-right[
.font90[

``` r
ols_2 &lt;- lm_robust(
* # I() transforms x
* LifeExpect ~ I(HealthExp / 1000) + # 1 unit increase = $1000
    year + socialist*equal_liberty, 
  data = Dat, clusters = country)
```
&lt;img src="12-Polys_files/figure-html/LifeExp3-1.png" width="90%" style="display: block; margin: auto;" /&gt;

.center[.alert[This clearly violates OLS' linearity assumption!]]
]]

---
# Health expenditures .font70[The goal]

.left-column[
We need a non-linear model:
  + Here: An initial steep increase, which progressively flattens out.]
.right-column[
&lt;img src="12-Polys_files/figure-html/LifeExp4-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse center middle

# .font80[Step 1: Get a first impression using LOWESS &lt;br&gt; (locally weighted scatterplot smoothing)]

---
class: clear
# LOWESS

.left-column[
- LOWESS is a *local* regression for every observation plus the (approx. 6) nearest observations to the left and right.
- It then combines all those regression lines into a *smoothed non-parametric* line.
- Beware, LOWESS tends to overfit to the particular data.
]

.right-column[
.panelset[
.panel[.panel-name[LOWESS idea]
&lt;img src="./media/LOWESS.png" width="70%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[LOWESS fit]
&lt;img src="12-Polys_files/figure-html/LifeExp4a-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Code]

``` r
# Start of the ggplot function, setting LifeExpect on the y-axis and HealthExp on the x-axis
ggplot(data = Dat, aes(y = LifeExpect, x = HealthExp)) +  
  # Add points to the plot, colored by country
  geom_point(aes(color = country), alpha = 0.5) +  
  # Add lines to the plot, colored by country
  geom_line(aes(color = country), alpha = 0.3) +  
  # Add direct labels, but only for Switzerland and Denmark after filtering the data
  geom_dl(data = Dat %&gt;% filter(country == "Switzerland" | country == "Denmark"),  
          # Label by country and place labels at the last points of the lines
          aes(label = country, color = country), method = list(dl.combine("last.points"))) +  
* # Add a LOWESS to the plot to show the overall trend, colored black.
* geom_smooth(color = "black") +
  labs(y = "Life expectacy at birth",  # Set the y-axis label
       x = "Health expenditure per capita in $") +  # Set the x-axis label
  theme_minimal() +  # Use a minimal theme for the plot
  guides(color = FALSE)  # Remove the legend for color
```
]]]

---
class: inverse center middle

# Step 2: Modeling non-linear relations &lt;br&gt;&lt;br&gt; Possibility 1:&lt;br&gt; *Polynomials*

---
layout: true
# Polynomials

.push-left[
.font70[

<div id="fyydptdphl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fyydptdphl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fyydptdphl thead, #fyydptdphl tbody, #fyydptdphl tfoot, #fyydptdphl tr, #fyydptdphl td, #fyydptdphl th {
  border-style: none;
}

#fyydptdphl p {
  margin: 0;
  padding: 0;
}

#fyydptdphl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fyydptdphl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fyydptdphl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fyydptdphl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fyydptdphl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fyydptdphl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fyydptdphl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fyydptdphl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fyydptdphl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fyydptdphl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fyydptdphl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fyydptdphl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fyydptdphl .gt_spanner_row {
  border-bottom-style: hidden;
}

#fyydptdphl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fyydptdphl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fyydptdphl .gt_from_md > :first-child {
  margin-top: 0;
}

#fyydptdphl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fyydptdphl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fyydptdphl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fyydptdphl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fyydptdphl .gt_row_group_first td {
  border-top-width: 2px;
}

#fyydptdphl .gt_row_group_first th {
  border-top-width: 2px;
}

#fyydptdphl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyydptdphl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fyydptdphl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fyydptdphl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fyydptdphl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyydptdphl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fyydptdphl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fyydptdphl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fyydptdphl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fyydptdphl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fyydptdphl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyydptdphl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fyydptdphl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fyydptdphl .gt_left {
  text-align: left;
}

#fyydptdphl .gt_center {
  text-align: center;
}

#fyydptdphl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fyydptdphl .gt_font_normal {
  font-weight: normal;
}

#fyydptdphl .gt_font_bold {
  font-weight: bold;
}

#fyydptdphl .gt_font_italic {
  font-style: italic;
}

#fyydptdphl .gt_super {
  font-size: 65%;
}

#fyydptdphl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fyydptdphl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fyydptdphl .gt_indent_1 {
  text-indent: 5px;
}

#fyydptdphl .gt_indent_2 {
  text-indent: 10px;
}

#fyydptdphl .gt_indent_3 {
  text-indent: 15px;
}

#fyydptdphl .gt_indent_4 {
  text-indent: 20px;
}

#fyydptdphl .gt_indent_5 {
  text-indent: 25px;
}

#fyydptdphl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fyydptdphl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">-102.907*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(46.761)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">I(HealthExp/1000)</td>
<td headers="Life Exp." class="gt_row gt_center">7.953***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.805)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">I((HealthExp/1000)^2)</td>
<td headers="Life Exp." class="gt_row gt_center">-0.748***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.137)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">year</td>
<td headers="Life Exp." class="gt_row gt_center">0.081***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.023)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.136*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.061)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">3.254+</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.857)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.086</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.085)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.607</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

---

.push-right[

``` r
ols_3 &lt;- lm_robust(
  LifeExpect ~ I(HealthExp/1000) + 
*   I((HealthExp/1000)^2) +
    year + socialist*equal_liberty, 
  data = Dat, clusters = country)
```

`$$Y_{i} = \alpha + \beta_{1}X_{1} + \beta_{2}X_{1}^2 + \ldots + e_{i}$$`
.content-box-green[.center[
Do you see any similarity to the logic of an interaction term?
]]]

---

.push-right[

`$$Y_{i} = \alpha + \beta_{1}X_{1} + \beta_{2}X_{1}^2 + \ldots + e_{i}$$`

.center[Interpretation:]

`\(\beta_{\text{HealthExp}}\)`: At 0, a $1000 increase in `HealthExp` is associated with an increase in life expectancy at birth of 7.953 years.

`\(\beta_{\text{HealthExp}^2}\)`: With every $1000 increase in `HealthExp`, this association declines by -0.748 years.
 - For example, the increase from $1000 to $2000 is associated with an increase in life expectancy at birth of `\(7.953 + ( 2 \times -0.748 ) = 6.457\)` years.
]

---
layout: true
# Polynomials

.push-left[
.font70[

``` r
ols_4 &lt;- lm_robust( LifeExpect ~ 
* poly(I(HealthExp/1000), degree = 2, raw = TRUE) + # Better use poly()
    year + socialist*equal_liberty, data = Dat, clusters = country)
```
<div id="oodnybmyus" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oodnybmyus table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oodnybmyus thead, #oodnybmyus tbody, #oodnybmyus tfoot, #oodnybmyus tr, #oodnybmyus td, #oodnybmyus th {
  border-style: none;
}

#oodnybmyus p {
  margin: 0;
  padding: 0;
}

#oodnybmyus .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oodnybmyus .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oodnybmyus .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oodnybmyus .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oodnybmyus .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oodnybmyus .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oodnybmyus .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oodnybmyus .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oodnybmyus .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oodnybmyus .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oodnybmyus .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oodnybmyus .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oodnybmyus .gt_spanner_row {
  border-bottom-style: hidden;
}

#oodnybmyus .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oodnybmyus .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oodnybmyus .gt_from_md > :first-child {
  margin-top: 0;
}

#oodnybmyus .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oodnybmyus .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oodnybmyus .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oodnybmyus .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oodnybmyus .gt_row_group_first td {
  border-top-width: 2px;
}

#oodnybmyus .gt_row_group_first th {
  border-top-width: 2px;
}

#oodnybmyus .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oodnybmyus .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oodnybmyus .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oodnybmyus .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oodnybmyus .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oodnybmyus .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oodnybmyus .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oodnybmyus .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oodnybmyus .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oodnybmyus .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oodnybmyus .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oodnybmyus .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oodnybmyus .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oodnybmyus .gt_left {
  text-align: left;
}

#oodnybmyus .gt_center {
  text-align: center;
}

#oodnybmyus .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oodnybmyus .gt_font_normal {
  font-weight: normal;
}

#oodnybmyus .gt_font_bold {
  font-weight: bold;
}

#oodnybmyus .gt_font_italic {
  font-style: italic;
}

#oodnybmyus .gt_super {
  font-size: 65%;
}

#oodnybmyus .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oodnybmyus .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oodnybmyus .gt_indent_1 {
  text-indent: 5px;
}

#oodnybmyus .gt_indent_2 {
  text-indent: 10px;
}

#oodnybmyus .gt_indent_3 {
  text-indent: 15px;
}

#oodnybmyus .gt_indent_4 {
  text-indent: 20px;
}

#oodnybmyus .gt_indent_5 {
  text-indent: 25px;
}

#oodnybmyus .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oodnybmyus div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">-102.907*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(46.761)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 2, raw = TRUE)1</td>
<td headers="Life Exp." class="gt_row gt_center">7.953***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.805)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 2, raw = TRUE)2</td>
<td headers="Life Exp." class="gt_row gt_center">-0.748***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.137)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">year</td>
<td headers="Life Exp." class="gt_row gt_center">0.081***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.023)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.136*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.061)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">3.254+</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.857)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.086</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.085)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.607</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

---

.push-right[

`$$Y_{i} = \alpha + \beta_{1}X_{1} + \beta_{2}X_{1}^2 + \ldots + e_{i}$$`

.center[Interpretation:]

`\(\beta_{\text{HealthExp}}\)`: At $0, a $1000 increase in `HealthExp` is associated with an increase in life expectancy at birth of 7.953 years.

`\(\beta_{\text{HealthExp}^2}\)`: With every $1000 increase in `HealthExp`, this association declines by -0.748 years.
 - For example, the increase from $1000 to $2000 is associated with an increase in life expectancy at birth of `\(7.953 + ( 2 \times -0.748 ) = 6.457\)` years.

.center[.alert[This is complex; so plot it!]]
]

---

.push-right[
.panelset[
.panel[.panel-name[Fictional data]
.font90[

``` r
(fict_dat &lt;- tibble( # 1. Make fictional data
  # Realistic variation in x: Min to max
  HealthExp = min(Dat$HealthExp):max(Dat$HealthExp), 
  # Hold other variables constant.
  socialist = 0, # Non-socialist
  equal_liberty = 1, # Max democracy
  year = 2022)) # most recent date
# # A tibble: 12,429 × 4
#    HealthExp socialist equal_liberty  year
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022
#  2      7.11         0             1  2022
#  3      8.11         0             1  2022
#  4      9.11         0             1  2022
#  5     10.1          0             1  2022
#  6     11.1          0             1  2022
#  7     12.1          0             1  2022
#  8     13.1          0             1  2022
#  9     14.1          0             1  2022
# 10     15.1          0             1  2022
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Predict]
.font90[

``` r
(fict_dat &lt;- predict( # 2. Add predctions based on the model
  ols_4, newdata = fict_dat,
  interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 12,429 × 7
#    HealthExp socialist equal_liberty  year   fit   lwr   upr
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022  64.8  62.6  67.0
#  2      7.11         0             1  2022  64.8  62.6  67.0
#  3      8.11         0             1  2022  64.9  62.7  67.1
#  4      9.11         0             1  2022  64.9  62.7  67.1
#  5     10.1          0             1  2022  64.9  62.7  67.1
#  6     11.1          0             1  2022  64.9  62.7  67.1
#  7     12.1          0             1  2022  64.9  62.7  67.1
#  8     13.1          0             1  2022  64.9  62.7  67.1
#  9     14.1          0             1  2022  64.9  62.7  67.1
# 10     15.1          0             1  2022  64.9  62.7  67.1
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Plot]
.font70[
&lt;img src="12-Polys_files/figure-html/predictions2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Plot code]
.font90[

``` r
# 3. plot the predictions
ggplot(data = fict_dat, aes(y = fit, x = HealthExp)) +
  # Add a ribbon for uncertainty (likely confidence intervals)
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.5) +  
  geom_line() +  # Add a line for the fitted values
  geom_text(
    data = Dat %&gt;%  # Use original 'Dat' data for labeling
      filter(year == 2022 &amp;  # Filter for the year 2022 and specific countries
               (country == "Mali" | country == "Nepal" | 
                  country == "Morocco" | country == "Mexico" | 
                  country == "Poland" | country == "Japan" | 
                  country == "Denmark" | country == "Switzerland" |
                  country == "United States")), 
    # Position labels using actual life expectancy and health expenditure
    aes(y = LifeExpect, HealthExp, label = country)) + 
  labs(title = "Predictions based on multiple OLS",  # Set the plot title
       x = "By Healthcare Expenditures in $ \n(Socialism, Citizenship rights, and time held constant)",
       y = "Predicted Life expectancy at birth") +  # Set y-axis label
  theme_minimal()  # Use a minimal theme
```
]]]]


---
layout: true
class: clear
# Higher order Polynomials .font70[Beware of overfitting!]

.push-left[
.font80[

``` r
ols_5 &lt;- lm_robust(LifeExpect ~ 
*       poly(I(HealthExp/1000), degree = 4, raw = TRUE) +
        year + socialist*equal_liberty, data = Dat, clusters = country)
```
<div id="oytvivobbx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oytvivobbx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oytvivobbx thead, #oytvivobbx tbody, #oytvivobbx tfoot, #oytvivobbx tr, #oytvivobbx td, #oytvivobbx th {
  border-style: none;
}

#oytvivobbx p {
  margin: 0;
  padding: 0;
}

#oytvivobbx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oytvivobbx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oytvivobbx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oytvivobbx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oytvivobbx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oytvivobbx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oytvivobbx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oytvivobbx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oytvivobbx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oytvivobbx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oytvivobbx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oytvivobbx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oytvivobbx .gt_spanner_row {
  border-bottom-style: hidden;
}

#oytvivobbx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oytvivobbx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oytvivobbx .gt_from_md > :first-child {
  margin-top: 0;
}

#oytvivobbx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oytvivobbx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oytvivobbx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oytvivobbx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oytvivobbx .gt_row_group_first td {
  border-top-width: 2px;
}

#oytvivobbx .gt_row_group_first th {
  border-top-width: 2px;
}

#oytvivobbx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oytvivobbx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oytvivobbx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oytvivobbx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oytvivobbx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oytvivobbx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oytvivobbx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oytvivobbx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oytvivobbx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oytvivobbx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oytvivobbx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oytvivobbx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oytvivobbx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oytvivobbx .gt_left {
  text-align: left;
}

#oytvivobbx .gt_center {
  text-align: center;
}

#oytvivobbx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oytvivobbx .gt_font_normal {
  font-weight: normal;
}

#oytvivobbx .gt_font_bold {
  font-weight: bold;
}

#oytvivobbx .gt_font_italic {
  font-style: italic;
}

#oytvivobbx .gt_super {
  font-size: 65%;
}

#oytvivobbx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oytvivobbx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oytvivobbx .gt_indent_1 {
  text-indent: 5px;
}

#oytvivobbx .gt_indent_2 {
  text-indent: 10px;
}

#oytvivobbx .gt_indent_3 {
  text-indent: 15px;
}

#oytvivobbx .gt_indent_4 {
  text-indent: 20px;
}

#oytvivobbx .gt_indent_5 {
  text-indent: 25px;
}

#oytvivobbx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oytvivobbx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">-55.525</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(49.258)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 4, raw = TRUE)1</td>
<td headers="Life Exp." class="gt_row gt_center">17.635***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.522)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 4, raw = TRUE)2</td>
<td headers="Life Exp." class="gt_row gt_center">-5.379***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.799)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 4, raw = TRUE)3</td>
<td headers="Life Exp." class="gt_row gt_center">0.659***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.144)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">poly(I(HealthExp/1000), degree = 4, raw = TRUE)4</td>
<td headers="Life Exp." class="gt_row gt_center">-0.027***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.008)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">year</td>
<td headers="Life Exp." class="gt_row gt_center">0.057*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.024)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.152**</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.054)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">2.163</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.725)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.132+</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.072)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.677</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

---
.push-right[
.panelset[
.panel[.panel-name[Fictional data]
.font90[

``` r
(fict_dat &lt;- tibble( # 1. Make fictional data
  # Realistic variation in x: Min to max
  HealthExp = min(Dat$HealthExp):max(Dat$HealthExp), 
  # Hold other variables constant.
  socialist = 0, # Non-socialist
  equal_liberty = 1, # Max democracy
  year = 2022)) # most recent date
# # A tibble: 12,429 × 4
#    HealthExp socialist equal_liberty  year
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022
#  2      7.11         0             1  2022
#  3      8.11         0             1  2022
#  4      9.11         0             1  2022
#  5     10.1          0             1  2022
#  6     11.1          0             1  2022
#  7     12.1          0             1  2022
#  8     13.1          0             1  2022
#  9     14.1          0             1  2022
# 10     15.1          0             1  2022
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Predict]
.font90[

``` r
(fict_dat &lt;- predict( # 2. Get predictions
  ols_5, newdata = fict_dat,
  interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 12,429 × 7
#    HealthExp socialist equal_liberty  year   fit   lwr   upr
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022  61.5  59.3  63.7
#  2      7.11         0             1  2022  61.5  59.3  63.7
#  3      8.11         0             1  2022  61.5  59.3  63.7
#  4      9.11         0             1  2022  61.5  59.3  63.8
#  5     10.1          0             1  2022  61.6  59.4  63.8
#  6     11.1          0             1  2022  61.6  59.4  63.8
#  7     12.1          0             1  2022  61.6  59.4  63.8
#  8     13.1          0             1  2022  61.6  59.4  63.8
#  9     14.1          0             1  2022  61.6  59.4  63.8
# 10     15.1          0             1  2022  61.6  59.5  63.8
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Plot]
&lt;img src="12-Polys_files/figure-html/predictions3-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Plot code]
.font90[

``` r
# 3. Plot the predictions
ggplot(data = fict_dat, aes(y = fit, x = HealthExp)) +
  # Add a ribbon for uncertainty (likely confidence intervals)
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.5) +  
  geom_line() +  # Add a line for the fitted values
  geom_text(
    data = Dat %&gt;%  # Use original 'Dat' data for labeling
      filter(year == 2022 &amp;  # Filter for the year 2022 and specific countries
               (country == "Mali" | country == "Nepal" | 
                  country == "Morocco" | country == "Mexico" | 
                  country == "Poland" | country == "Japan" | 
                  country == "Denmark" | country == "Switzerland" |
                  country == "United States")), 
    # Position labels using actual life expectancy and health expenditure
    aes(y = LifeExpect, HealthExp, label = country)) + 
  labs(title = "Predictions based on multiple OLS",  # Set the plot title
       x = "By Healthcare Expenditures in $ \n(Socialism, Citizenship rights, and time held constant)",
       y = "Predicted Life expectancy at birth") +  # Set y-axis label
  theme_minimal()  # Use a minimal theme
```
]]]]

---

.push-right[
With a unit increase in `\(X\)`, each polynomial always alters the one before it:

`\(\beta_{\text{HealthExp}}\)`: At $0, a $1000 increase in `HealthExp` is associated with an increase in life expectancy at birth of 17.635 years.

`\(\beta_{\text{HealthExp}^2}\)`: With every $1000 increase in `HealthExp`, `\(\beta_{\text{HealthExp}}\)` changes by -5.379.

`\(\beta_{\text{HealthExp}^3}\)`: With every $1000 increase in `HealthExp`, `\(\beta_{\text{HealthExp}^2}\)` changes by `\(0.659\)`.

`\(\beta_{\text{HealthExp}^4}\)`: With every $1000 increase in `HealthExp`, `\(\beta_{\text{HealthExp}^3}\)` changes by `\(-0.027\)`.

.center[.alert[It gets super abstract; so always plot the implied association!]]
]

---
layout: false
# Polynomials .font70[in a nutshell]
`$$Y_{i} = \alpha + \beta_{1}X_{1} + \beta_{2}X_{1}^2 + \ldots + e_{i}$$`
.push-left[
.content-box-blue[
- You can best think of a polynomial as an interaction of a variable with itself.
  + Polynomials *linearize* non-linear associations


- The more polynomials, the more complex and "wobbly" the non-linear relation.
  + Beware to not overfit the model to the particular data. .alert[In Sociology, it rarely makes sense to use polynomials beyond 2 or 3.]


- In a multiple OLS framework, we can control for other variables.
]]

.push-right[
&lt;img src="12-Polys_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# Break

&lt;iframe src='https://panel.letstimeit.com/instant-timer/15-minute' width='600' height='400' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://www.laserfiche.com/wp-content/uploads/2014/10/femalecoder.jpg" width="80%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://panel.letstimeit.com/instant-timer/20-minute' width='600' height='400' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

]

.right-column[
&lt;br&gt;
&lt;iframe src='exercise1.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse middle center
# Break

&lt;iframe src='https://panel.letstimeit.com/instant-timer/10-minute' width='600' height='400' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;


---
class: inverse center middle

# Modeling non-linear relations &lt;br&gt;&lt;br&gt; Possibility 2:&lt;br&gt; *Data transformation*

---
layout: true
# Transform `\(Y\)` or `\(X\)` .font70[Our favorite: The logarithm]

.push-left[
- Sometimes it helps to transform `\(Y\)` and/or `\(X\)`. Textbooks discuss several transformations. .alert[The most common and useful is log()/ln().]

&lt;img src="https://helpingwithmath.com/wp-content/uploads/2021/10/Logarithms-1.png" width="60%" style="display: block; margin: auto;" /&gt;

`$$\text{Example 1: }\log_2(32)=5 \leftrightarrow 2^5 = 32$$`
`$$\text{Example 1: }\log_2(4)=2 \leftrightarrow 2^2 = 4$$`
- When we use log to the base 2, .alert[an increase of the exponent by 1 implies a doubling of the original value/argument!]
]

---
.push-right[
`$$Y_{i} = \alpha + \beta \log_2(X_{i}) + e_{i}$$`
&lt;img src="12-Polys_files/figure-html/LifeExp5-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

.push-right[
`$$Y_{i} = \alpha + \beta \log_2(X_{i}) + e_{i}$$`
&lt;img src="12-Polys_files/figure-html/LifeExp6-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

.push-right[
`$$Y_{i} = \alpha + \beta \log_2(X_{i}) + e_{i}$$`
&lt;img src="12-Polys_files/figure-html/LifeExp7-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
layout: true
# `\(\log_2\)` transformed `\(X\)`

.push-left[
.font80[

<div id="rzqnxfszwc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rzqnxfszwc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rzqnxfszwc thead, #rzqnxfszwc tbody, #rzqnxfszwc tfoot, #rzqnxfszwc tr, #rzqnxfszwc td, #rzqnxfszwc th {
  border-style: none;
}

#rzqnxfszwc p {
  margin: 0;
  padding: 0;
}

#rzqnxfszwc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzqnxfszwc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rzqnxfszwc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzqnxfszwc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzqnxfszwc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzqnxfszwc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzqnxfszwc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzqnxfszwc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzqnxfszwc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzqnxfszwc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzqnxfszwc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzqnxfszwc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzqnxfszwc .gt_spanner_row {
  border-bottom-style: hidden;
}

#rzqnxfszwc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rzqnxfszwc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rzqnxfszwc .gt_from_md > :first-child {
  margin-top: 0;
}

#rzqnxfszwc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzqnxfszwc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzqnxfszwc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rzqnxfszwc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzqnxfszwc .gt_row_group_first td {
  border-top-width: 2px;
}

#rzqnxfszwc .gt_row_group_first th {
  border-top-width: 2px;
}

#rzqnxfszwc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzqnxfszwc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzqnxfszwc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzqnxfszwc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzqnxfszwc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzqnxfszwc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzqnxfszwc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rzqnxfszwc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzqnxfszwc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzqnxfszwc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzqnxfszwc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzqnxfszwc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzqnxfszwc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzqnxfszwc .gt_left {
  text-align: left;
}

#rzqnxfszwc .gt_center {
  text-align: center;
}

#rzqnxfszwc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzqnxfszwc .gt_font_normal {
  font-weight: normal;
}

#rzqnxfszwc .gt_font_bold {
  font-weight: bold;
}

#rzqnxfszwc .gt_font_italic {
  font-style: italic;
}

#rzqnxfszwc .gt_super {
  font-size: 65%;
}

#rzqnxfszwc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rzqnxfszwc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzqnxfszwc .gt_indent_1 {
  text-indent: 5px;
}

#rzqnxfszwc .gt_indent_2 {
  text-indent: 10px;
}

#rzqnxfszwc .gt_indent_3 {
  text-indent: 15px;
}

#rzqnxfszwc .gt_indent_4 {
  text-indent: 20px;
}

#rzqnxfszwc .gt_indent_5 {
  text-indent: 25px;
}

#rzqnxfszwc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rzqnxfszwc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a-"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Life-Exp.">Life Exp.</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=" " class="gt_row gt_left">(Intercept)</td>
<td headers="Life Exp." class="gt_row gt_center">16.744</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(45.180)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">I(log2(HealthExp))</td>
<td headers="Life Exp." class="gt_row gt_center">3.646***</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.179)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">year</td>
<td headers="Life Exp." class="gt_row gt_center">0.010</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.023)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist</td>
<td headers="Life Exp." class="gt_row gt_center">0.113*</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(0.054)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">0.918</td></tr>
    <tr><td headers=" " class="gt_row gt_left"></td>
<td headers="Life Exp." class="gt_row gt_center">(1.689)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">socialist × equal_liberty</td>
<td headers="Life Exp." class="gt_row gt_center">-0.087</td></tr>
    <tr><td headers=" " class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;"></td>
<td headers="Life Exp." class="gt_row gt_center" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">(0.070)</td></tr>
    <tr><td headers=" " class="gt_row gt_left">Num.Obs.</td>
<td headers="Life Exp." class="gt_row gt_center">3897</td></tr>
    <tr><td headers=" " class="gt_row gt_left">R2</td>
<td headers="Life Exp." class="gt_row gt_center">0.720</td></tr>
  </tbody>
  <tfoot>
    <tr class="gt_sourcenotes">
      <td class="gt_sourcenote" colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td>
    </tr>
  </tfoot>
</table>
</div>
]]

---

.push-right[.font80[

``` r
*ols_6 &lt;- lm_robust(LifeExpect ~ I(log2(HealthExp)) +
                     year + socialist*equal_liberty, 
                   data = Dat, clusters = country)
```
]
.content-box-green[
How can we interpret the coefficient of 3.646?
]]

---

.push-right[
.panelset[
.panel[.panel-name[Fictional data]
.font90[

``` r
(fict_dat &lt;- tibble( # 1. Make fictional data
  # Realistic variation in x: Min to max
  HealthExp = min(Dat$HealthExp):max(Dat$HealthExp), 
  # Hold other variables constant.
  socialist = 0, # Non-socialist
  equal_liberty = 1, # Max democracy
  year = 2022)) # most recent date
# # A tibble: 12,429 × 4
#    HealthExp socialist equal_liberty  year
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022
#  2      7.11         0             1  2022
#  3      8.11         0             1  2022
#  4      9.11         0             1  2022
#  5     10.1          0             1  2022
#  6     11.1          0             1  2022
#  7     12.1          0             1  2022
#  8     13.1          0             1  2022
#  9     14.1          0             1  2022
# 10     15.1          0             1  2022
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Predict]
.font90[

``` r
(fict_dat &lt;- predict( # 2. Get predictions
  ols_6, newdata = fict_dat,
  interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 12,429 × 7
#    HealthExp socialist equal_liberty  year   fit   lwr   upr
#        &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1      6.11         0             1  2022  46.8  43.3  50.2
#  2      7.11         0             1  2022  47.6  44.2  50.9
#  3      8.11         0             1  2022  48.3  45.0  51.6
#  4      9.11         0             1  2022  48.9  45.6  52.1
#  5     10.1          0             1  2022  49.4  46.2  52.6
#  6     11.1          0             1  2022  49.9  46.8  53.1
#  7     12.1          0             1  2022  50.4  47.3  53.5
#  8     13.1          0             1  2022  50.8  47.7  53.9
#  9     14.1          0             1  2022  51.2  48.2  54.2
# 10     15.1          0             1  2022  51.5  48.5  54.5
# # ℹ 12,419 more rows
```
]]
.panel[.panel-name[Plot]
&lt;img src="12-Polys_files/figure-html/predictions4-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Plot code]
.font90[

``` r
# 3. Plot the predictions
ggplot(data = fict_dat, aes(y = fit, x = HealthExp)) +
  # Add a ribbon for uncertainty (likely confidence intervals)
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.5) +  
  geom_line() +  # Add a line for the fitted values
  geom_text(
    data = Dat %&gt;%  # Use original 'Dat' data for labeling
      filter(year == 2022 &amp;  # Filter for the year 2022 and specific countries
               (country == "Mali" | country == "Nepal" | 
                  country == "Morocco" | country == "Mexico" | 
                  country == "Poland" | country == "Japan" | 
                  country == "Denmark" | country == "Switzerland" |
                  country == "United States")), 
    # Position labels using actual life expectancy and health expenditure
    aes(y = LifeExpect, HealthExp, label = country)) + 
  labs(title = "Predictions based on multiple OLS",  # Set the plot title
       x = "By Healthcare Expenditures in $ \n(Socialism, Citizenship rights, and time held constant)",
       y = "Predicted Life expectancy at birth") +  # Set y-axis label
  theme_minimal()  # Use a minimal theme
```
]]]]

---
layout: false
class: clear
# Which is better polynomials or `\(\log_2(X)\)`?

.right-column[
.font80[

```
# 
# =========================================================================
#                                                Model 1       Model 2     
# -------------------------------------------------------------------------
# (Intercept)                                     -55.525        16.744    
#                                                 (49.258)      (45.180)   
# poly(HealthExp/1000), degree = 4, raw = TRUE1    17.635 ***              
#                                                  (1.522)                 
# poly(HealthExp/1000), degree = 4, raw = TRUE2    -5.379 ***              
#                                                  (0.799)                 
# poly(HealthExp/1000), degree = 4, raw = TRUE3     0.659 ***              
#                                                  (0.144)                 
# poly(HealthExp/1000), degree = 4, raw = TRUE4    -0.027 **               
#                                                  (0.008)                 
# year                                              0.057 *       0.010    
#                                                  (0.024)       (0.023)   
# socialist                                         0.152 *       0.113    
#                                                  (0.054)       (0.054)   
# equal_liberty                                     2.163         0.918    
#                                                  (1.725)       (1.689)   
# socialist:equal_liberty                          -0.132        -0.087    
#                                                  (0.072)       (0.070)   
# log2(HealthExp)                                                 3.646 ***
#                                                                (0.179)   
# -------------------------------------------------------------------------
# R^2                                               0.677         0.720    
# Adj. R^2                                          0.677         0.719    
# Num. obs.                                      3897          3897        
# RMSE                                              5.112         4.763    
# N Clusters                                      172           172        
# =========================================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

--

.left-column[
In this case, the `\(R^{2}\)` and the Adjusted `\(R^{2}\)` (which penalizes additional predictors, that is, overtly complex models) both suggest: `\(\log_2(X)\)` describes the relationship better.

It also better fits our theoretical intuition of the process.
]

---
layout: false
class: inverse center middle

# Modeling non-linear relations &lt;br&gt;&lt;br&gt; Possibility 3:&lt;br&gt; *Generalized Linear Models with link functions*

`$$Y_{i} = g^{-1}(\alpha + \beta_{1}X_{i1} + \ldots)$$`
## Later in your studies ...

---
class: inverse middle center
# Break

&lt;iframe src='https://panel.letstimeit.com/instant-timer/15-minute' width='600' height='400' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://www.laserfiche.com/wp-content/uploads/2014/10/femalecoder.jpg" width="80%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://panel.letstimeit.com/instant-timer/20-minute' width='600' height='400' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

]

.right-column[
&lt;br&gt;
&lt;iframe src='exercise2.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]


---
layout: false
class: inverse
# Today's general lessons

1. Although OLS estimates linear models, we can "linearize" non-linear relationships. We can do so in two ways: by using polynomials, or by transforming `\(Y\)` or `\(X\)`.
2. Polynomials are basically interaction terms of a variable with itself. By introducing `\(X^2\)`, or even higher order polynomials to our model, we let `\(\beta_{x}\)` change with a change in `\(X\)`. Importantly, every polynomial moderates/aletrs the one before it with a unit increase in `\(X\)`. 
3. Polynomials allow us to model very complex relationships. But we should be careful to not overfit the model to our particular data. Usually, a simple polynomial (i.e. `\(x\)` and `\(X^2\)` are enough).
4. An alternative to polynomials is to transform `\(Y\)` and/or `\(X\)`. Many algebraic transformations are possible. But one of the most useful is the logarithm, which allows us to express `\(Y\)` or `\(X\)` in terms of rates of change instead of absolute unit increases.


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../template/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "highlightLanguage": "r",
  "highlightStyle": "zenburn",
  "highlightLines": true,
  "countIncrementalSlides": false,
  "ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
