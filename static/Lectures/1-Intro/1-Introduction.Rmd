---
title: "Multiple Regression & <br><br> Fundamentals of Causal Inference"
subtitle: "<br>1. Introduction"
author: "Merlin Schaeffer<br> Department of Sociology"
date: "`r Sys.Date()`"
output: 
  xaringan::moon_reader:
    chakra: "../template/remark-latest.min.js"
    css: ["../template/Merlin169.css"]
    lib_dir: libs
    # self_contained: true
    nature:
      highlightLanguage: r
      highlightStyle: zenburn
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
---
```{r setup, include = FALSE}
library(RefManageR)
library(knitr)
library(ggrepel) # Nicely placed labels in figures.
library(modelr)
library(webexercises) # Small web-based answer scales.
library(equatiomatic) # Regression equations from model objects.

options(htmltools.preserve.raw = FALSE,
        htmltools.dir.version = FALSE, servr.interval = 0.5, width = 115, digits = 3)
knitr::opts_chunk$set(
  collapse = TRUE, message = FALSE, fig.retina = 3, error = TRUE,
  warning = FALSE, cache = FALSE, fig.align = 'center',
  comment = "#", strip.white = TRUE, tidy = FALSE)

BibOptions(check.entries = FALSE, 
           bib.style = "authoryear", 
           style = "markdown",
           hyperlink = FALSE,
           no.print.fields = c("doi", "url", "ISSN", "urldate", "language", "note", "isbn", "volume"))
myBib <- ReadBib("./../../../Stats_II.bib", check = FALSE)

xaringanExtra::use_xaringan_extra(c("tile_view", "tachyons"))
xaringanExtra::use_panelset()
```
class: middle center
background-image: url("https://stanfordbloodcenter.org/wp-content/uploads/2021/01/iStock-1208283967.jpg")
background-position: center
background-size: cover

.font160[
**My research agenda**
]
.font200[
**Theory-driven empirical analysis of <br><br>immigration-based ethnic diversity and stratification,<br><br> including their contentious political consequences.**
]


---
layout: true
# Some of my current work

---

.left-column[
```{r, echo = FALSE, out.width='100%'}
knitr::include_graphics('https://www.templehealth.org/sites/default/files/styles/without_crop/public/2021-01/man-wearing-mask-coughing-into-shoulder.jpg?itok=Z6mUgWPd')
```
]


.right-column[
```{r, echo = FALSE, out.width='100%'}
knitr::include_graphics('./img/Paired_Vignette.png')
```
.center[.backgrnote[*Source*: `r Citet(myBib, "schaeffer_who_2023")`]]
]

---


```{r, echo = FALSE, out.width='80%'}
knitr::include_graphics('./img/jcac025f1.jpeg')
```
.center[.backgrnote[*Source*: `r Citet(myBib, "schaeffer_who_2023")`]]

---

```{r, echo = FALSE, out.width='45%'}
knitr::include_graphics('./img/Krzysz.png')
```
.center[.backgrnote[*Source*: `r Citet(myBib, "krakowski_populist_2022")`]]

---

```{r, echo = FALSE, out.width='80%'}
knitr::include_graphics('./img/Ethnic_Discr2-1.png')
```
.center[.backgrnote[*Source*: `r Citet(myBib, "krakowski_populist_2022")`]]

---


```{r, echo = FALSE, out.width='45%'}
knitr::include_graphics('./img/Wiedner.png')
```
.center[.backgrnote[*Source*: `r Citet(myBib, "wiedner_ethno-religious_2023")`]]

---
layout: false
class: middle center

.font200[
Did you the [**setup**](https://merlin-ols.netlify.app/about/) <br><br> and are you ready to go?
]

---
layout: false
class: inverse
# I assume

1. You have basic R coding skills and know how to use RStudio.

--

2. You know basic statistics:
  + Descriptive statistics: $\%$, $\bar{x}$, $\text{SD}(x)$.
  + Associations: Correlation $r_{y,x}$ & OLS regression $y_{i} = \alpha + \beta x_{i} + \epsilon_{i}$.
  + Inference: Confidence intervals, $t$-values & $p$-values.

---
class: inverse
# Today's schedule

1. Explanatory sociology

2. Three learning goals
  1. Advanced OLS regression
  2. Visualization of regression results
  3. Causal inference
  
3. Course organization

---
class: inverse middle center
# Explanatory Sociology

---
# 4 Types of research questions

.push-left[
**(1) Ontological**: What is the nature of .alert[X]?
  + What is power?
  + What is gender; how is it different from race?
  + What is a state? .backgrnote[
> A human community that (successfully) claims the monopoly of the legitimate use of physical force within a given territory

> -- Max Weber, "Politics as a Vocation" 1918]



**(2) Critical**: Is .alert[X] (un-)just?
  + Is home office exploitation?
  + Is the color-blind ideology a new form of racism?
]

--

.push-right[
**(3) Descriptive**: What types of .alert[X] exist<br> and how frequent are they?
  + What are the survival strategies of the poor?
  + How did Danes structure their days during the COVID-19 lockdowns?



**(4) Explanatory**: What is the effect of .alert[X]? <br> .backgrnote[(Vice versa: How does .alert[Y] come about?)]
  - What are the consequences of anomie? <br> .backgrnote[Why does the suicide rate vary across societies?]
  - How does capitalism affect us?
  - How does urbanization affect us?
  - .backgrnote[Why do people obey power?]
  - .backgrnote[How does a state gain legitimacy over the use of physical force?]
]

--

.content-box-green[
.center[
Think of the last exam you wrote. What type of research question did it enage with?
]]

---
# 4 Types of research questions

.push-left[
**(1) Ontological**: What is the nature of .alert[X]?
  + What is power?
  + What is gender; how is it different from race?
  + What is a state? .backgrnote[
> A human community that (successfully) claims the monopoly of the legitimate use of physical force within a given territory

> -- Max Weber, "Politics as a Vocation" 1918]



**(2) Critical**: Is .alert[X] (un-)just?
  + Is home office exploitation?
  + Is the color-blind ideology a new form of racism?
]

.push-right[
**(3) Descriptive**: What types of .alert[X] exist<br> and how frequent are they?
  + What are the survival strategies of the poor?
  + How did Danes structure their days during the COVID-19 lockdowns?


.content-box-red[
**(4) Explanatory**: What is the effect of $X$? <br> .backgrnote[(Vice versa: How does .alert[Y] come about?)]
  - What are the consequences of anomie? <br> .backgrnote[Why does the suicide rate vary across societies?]
  - How does capitalism affect us?
  - How does urbanization affect us?
  - .backgrnote[Why do people obey power?]
  - .backgrnote[How does a state gain legitimacy over the use of physical force?]
]]

---
# Goal of empirical sociology

.font140[.center[.alert[Use data to discover patterns, <br> and the **social mechanisms that bring them about**.]]]

```{r, echo = FALSE, out.width='70%', fig.align='center'}
knitr::include_graphics('https://liu.se/-/media/istock-501261958.jpg?mw=1120&mh=1120&hash=DA8977CCE6A6E600AE80A40CFEE771C9')
```

---
class: inverse middle center
# Three learning goals

---
# Three learning goals

.push-left[
**(1) Multiple OLS regression**
  + Multiple predictors & confounder adjustment,
  + Interaction effects,
  + Polynomials.



**(2) Visualization of regression results**
  + Model predictions,
  + Coefficient plots.

```{r, echo = FALSE, out.width='65%', fig.align='center'}
knitr::include_graphics('https://www.journals.uchicago.edu/cms/10.1086/686942/asset/images/medium/fg3.gif')
```
.backgrnote[.center[*Source:* `r Citet(myBib, "legewie_contested_2016")`]]

]

--

.push-right[
**(3) Fundamentals of causal inference**
  + Potential outcomes and directed acyclical graphs,
  + Randomized Controlled Trials,
  + Intention to treat & instrument variable regression,
  + Multiple regression,
  + 2-SLS instrument variable regression,
  + Regression discontinuity designs.

```{tikz, DAG1,  echo = FALSE, out.width='45%'}
\usetikzlibrary{shapes,decorations,arrows,calc,arrows.meta,fit,positioning}
\tikzset{
    -Latex,auto,node distance =1 cm and 1 cm,semithick,
    state/.style ={ellipse, draw, minimum width = 0.7 cm},
    point/.style = {circle, draw, inner sep=0.04cm,fill,node contents={}},
    bidirected/.style={Latex-Latex,dashed},
    el/.style = {inner sep=2pt, align=left, sloped}
}

\begin{tikzpicture}
\sffamily
    \node[state] (1) at (0,0) {$C$};
    \node[state] (2) [below = of 1] {$X$};
    \node[state] (3) [right = of 2] {$Y$};

    \path (1) edge  (2);
    \path[bidirected] (2) edge[red, bend right=50] (3);
    \path (1) edge (3);
\end{tikzpicture}
```
]

---
layout: false
class: clear
# Example: Regression discontinuity design

.push-left[
```{r, echo = FALSE, out.width='62%', fig.align='center'}
knitr::include_graphics('https://pbs.twimg.com/media/FOH1FlhWUAIqbN1.jpg:large')
```
]

.push-right[
```{r, echo = FALSE, out.width='100%', fig.align='center'}
knitr::include_graphics('https://pbs.twimg.com/media/FZIn0ymXgAAOopA.jpg:large')
```
]

---
class: clear
# Example: Regression discontinuity design

.push-left[
```{r, echo = FALSE, out.width='62%', fig.align='center'}
knitr::include_graphics('https://pbs.twimg.com/media/FOH1FlhWUAIqbN1.jpg:large')
```
]


.push-right[
.center[Municipalities where far-right candidates *ran*
versus where they *won*]
```{r, echo = FALSE, out.width='100%', fig.align='center'}
knitr::include_graphics('./img/Map_Italy.png')
```
.backgrnote[.center[*Source:* `r Citet(myBib, "romarri_far-right_2020")`]]
]

---
class: clear
# Example: Regression discontinuity design

```{r, echo = FALSE, out.width='50%', fig.align='center'}
knitr::include_graphics('./img/Romarri.png')
```
.backgrnote[.center[*Source:* `r Citet(myBib, "romarri_far-right_2020")`]]

---
class: clear
# Example: Regression discontinuity design

```{r, echo = FALSE, out.width='90%', fig.align='center'}
knitr::include_graphics('./img/Right_Wing5-1.png')
```
.backgrnote[.center[*Source:* `r Citet(myBib, "krakowski_populist_2022")`]]


---
class: inverse middle center
# Break

<iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'></iframe>


---
layout: false
class: inverse middle center
# Course organization

---
# Weekly course elements

.left-column[
.center[**Recommendations**]
- Activate email notifications on Absalon.
- Regularly check your KU email or forward it to your personal email.
- Ask and answer questions in the [t-R-ouble forum](https://absalon.ku.dk/courses/70545/discussion_topics/563046?module_item_id=2037268) on Absalon.
]

.right-column[
```{r, echo = FALSE, out.width='100%', fig.align='center'}
knitr::include_graphics('./img/Structure.png')
```  
]

---
class: clear

```{r, echo = FALSE, out.width='70%', fig.align='center'}
knitr::include_graphics('./img/Quizz.png')
```  
---
# Weekly Absalon Online Quizzes

.left-column[
- 14 Online Quizzes on Absalon designed by Thorkil and Emil from [Epinion](https://epinionglobal.com/).
- Quizzes are based on real data Epinion collects for the municipality of Copenhagen, DR, Skat, and many more.
- You must .alert[submit at least 10 completed quizzes] to qualify for the integrated exam with "Velf√¶rd, ulighed og mobilitet".
- Quizzes must be submitted .alert[individually and within two weeks] after they are made available online (i.e., Wednesdays after the lecture).
]

.right-column[
```{r, echo = FALSE, out.width='90%', fig.align='center'}
knitr::include_graphics('./img/Quizz.png')
```  
]

---
class: clear
# AI & Large Language Models like ChatGPT

.push-left[
1. **Privacy**: Everything gets sent to OpenAI's servers. .alert[Don't use AI/LLMs to process sensitive information!]
2. **Learning**: Use AI/LLMs to *explain, comment, debug, and improve* R code that you drafted.
3. **Generation**: Don't use AI/LLMs to *generate, draft, and write* your R code. .alert[You need to learn how to code to assess whether ChatGPT coded what you asked for.]
4. **Citation**: You can use AI/LLMs but you need to explain how you used which AI/LLMs at the outset of your exam.
]

.push-right[
```{r, echo = FALSE, out.width='100%', fig.align='center'}
knitr::include_graphics('https://media1.giphy.com/media/iiSb58oATiANL65Dd2/giphy.gif?cid=ecf05e470i00dk1kq5bvalzh4irqygm4pieeqkdyz9vk76ht&ep=v1_gifs_search&rid=giphy.gif&ct=g')
```  
]

---
layout: true
# Working with various data sources

.left-column[
Throughout the lectures, holds, and weekly Absalon online quizzes, you will work with various different data sources.
]

---
.right-column[
.center[Data collected by the World Bank]
```{r, echo = FALSE, out.width='90%', fig.align='center'}
knitr::include_graphics('./../2-Correlation-n-Regression/2-Corr-n-Reg_files/figure-html/socialism-corr1-1.png')
```  

]

---

.right-column[
.center[APAX survey of immigrants and their descendants in Germany]
```{r, echo = FALSE, out.width='90%', fig.align='center'}
knitr::include_graphics('./../5-Selection-bias/5-Selection-bias_files/figure-html/naiv-1.png')
```  

]

---
layout: false
# Two textbooks

$\rightarrow$ Both textbooks are accessible at Academic Books and are available at the university library.

.push-left[
.center[The first textbook, carried over from last semester, serves as a reference for regression and statistical inference.]

```{r, echo = FALSE, out.width='40%', fig.align='center'}
knitr::include_graphics('https://imgcdn.saxo.com/_9781292362328')
```
.backgrnote[.center[`r Citet(myBib, "veaux_stats_2021")`]]
]

.push-right[
.center[To deepen our understanding of how regression analysis can be applied to identify causal effects, we will heavily rely on Angrist and Pischke's textbook]

```{r, echo = FALSE, out.width='35%', fig.align='center'}
knitr::include_graphics('https://imgcdn.saxo.com/_9780691152844')
```
.backgrnote[.center[`r Citet(myBib, "angrist_mastering_2014")`]]
]

---
class: inverse middle center
# Questions

```{r, echo = FALSE, out.width='50%', fig.align='center'}
knitr::include_graphics('https://www.mountpolley.com/wp-content/uploads/2020/08/pexels-pixabay-356079-1200x726.jpg')
```

---
# References

.push-left[
.font70[
```{r ref1, results = 'asis', echo = FALSE}
PrintBibliography(myBib, start = 1, end = 5)
```
]]

.push-right[
.font70[
```{r ref2, results = 'asis', echo = FALSE}
PrintBibliography(myBib, start = 6, end = length(myBib))
```
]]