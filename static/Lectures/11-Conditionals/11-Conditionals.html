<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Interaction/Conditional effects</title>
    <meta charset="utf-8" />
    <meta name="author" content="Merlin Schaeffer  Department of Sociology" />
    <meta name="date" content="2022-11-17" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="../template/Merlin169.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Interaction/Conditional effects
]
.subtitle[
## When the relation between <span class="math inline"><em>y</em></span> and <span class="math inline"><em>x</em><sub>1</sub></span> <br> depends on <span class="math inline"><em>x</em><sub>2</sub></span>
]
.author[
### Merlin Schaeffer<br> Department of Sociology
]
.date[
### 2022-11-17
]

---


# The goal of social science research

.font140[.center[.alert[Use data to &lt;ins&gt;discover patterns&lt;/ins&gt; ("social facts" in Durkheim's terms), &lt;br&gt; and the social mechanisms that bring them about.]]]

&lt;img src="https://liu.se/-/media/istock-501261958.jpg?mw=1120&amp;mh=1120&amp;hash=DA8977CCE6A6E600AE80A40CFEE771C9" width="70%" style="display: block; margin: auto;" /&gt;

---
class: inverse middle
# Today's schedule

1. Application of the day: Xenophobia and education in Denmark and Bulgaria

2. Two more IV applications: 

---
class: inverse 

&lt;img src="./img/xeno_quest.png" width="70%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

.push-left[
&lt;iframe src='https://www.dw.com/en/denmark-tells-syrian-refugees-to-return-to-damascus/a-57174584' width='700' height='430' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.push-right[
&lt;iframe src='https://www.dw.com/en/why-do-so-many-refugees-avoid-bulgaria/a-18707897' width='700' height='430' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]
---
# Preparations

.panelset[
.panel[.panel-name[Get the ESS data]
.left-column[
Download the "ESS9e03_1.sav" data from Absalon. Place them into the folder for this course and where you have your R-project.
]
.right-column[
.font90[

```r
pacman::p_load(
  tidyverse, # Data manipulation,
  haven, # Handle labelled data.
  ggplot2, # beautiful figures,
  estimatr, # Regression for weighted data,
  texreg) # regression tables with nice layout.

# Read the ESS round 9 data
ESS &lt;- read_spss("../../../assets/ESS9e03_1.sav") %&gt;%
  # Keep only Danes and Bulgarians
  filter(cntry == "DK" | cntry == "BG") %&gt;% 
  mutate( # Define variables as categorical and continuous
    cntry = as_factor(cntry) %&gt;% fct_relevel("Denmark"),
    gndr = as_factor(gndr),
    eduyrs = case_when( # Recode education to sensible levels
      eduyrs &lt; 9 ~ 9,
      eduyrs &gt; 21 ~ 21,
      TRUE ~zap_labels(eduyrs)),
    agea = zap_labels(agea),
    # Outcome: Subtract from maximum to turn the scale around
    imwbcnt = 10 - zap_labels(imwbcnt)) %&gt;%
  # Keep only a minimum set of variables we need today,
  select(idno, cntry, pspwght, gndr, eduyrs, agea, imwbcnt) %&gt;%
  drop_na() # Delete cases with missing values.
```
]]]
.panel[.panel-name[The resulting data]

```r
ESS
# # A tibble: 3,330 × 7
#     idno cntry    pspwght gndr   eduyrs  agea imwbcnt
#    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
#  1     2 Bulgaria   0.933 Female     12    72       9
#  2    27 Bulgaria   0.455 Male       17    63       8
#  3    37 Bulgaria   1.02  Male        9    74       8
#  4    50 Bulgaria   0.845 Female     12    39       7
#  5    70 Bulgaria   0.740 Female     12    70       5
#  6    76 Bulgaria   0.704 Female     12    52       3
#  7   137 Bulgaria   1.86  Male        9    24       5
#  8   182 Bulgaria   0.503 Male       17    58       4
#  9   208 Bulgaria   1.32  Male       12    52       1
# 10   234 Bulgaria   1.49  Male       17    76       7
# # … with 3,320 more rows
```
]]

---
# Multiple OLS

.panelset[
.panel[.panel-name[Denmark vis-á-vis Bulgaria]

.push-right[
.font90[

```
# 
# =======================================================
#                Model 1       Model 2       Model 3     
# -------------------------------------------------------
# (Intercept)       4.326 ***     4.909 ***     4.206 ***
#                  (0.071)       (0.213)       (0.237)   
# cntryBulgaria     1.680 ***     1.635 ***     1.608 ***
#                  (0.098)       (0.100)       (0.100)   
# eduyrs                         -0.043 **     -0.040 ** 
#                                (0.014)       (0.014)   
# agea                                          0.014 ***
#                                              (0.003)   
# -------------------------------------------------------
# R^2               0.113         0.116         0.128    
# Adj. R^2          0.113         0.116         0.127    
# Num. obs.      3330          3330          3330        
# RMSE              2.348         2.344         2.329    
# =======================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

.push-left[
&lt;img src="11-Conditionals_files/figure-html/Coefplot-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Code]
.push-left[
.font90[

```r
bind_rows( # Combine estimate results into one tibble,
  ols_bi %&gt;% tidy(),
  ols_mult_1 %&gt;% tidy(),
  ols_mult_2 %&gt;% tidy(),
  .id = "model") %&gt;%
  filter(term == "cntryBulgaria") %&gt;% # Keep country estimates,
  mutate( # Rename the model variable,
    term = case_when(
      model == 1 ~ "Bivariate",
      model == 2 ~ "Adjusted for education",
      model == 3 ~ "Adjusted for education and age") %&gt;%
      fct_relevel("Adjusted for education and age", 
                  "Adjusted for education",
                  "Bivariate")) %&gt;%
  ggplot(aes(y = estimate, x = term, # Plot the results,
             ymin = conf.low, ymax = conf.high)) +
  geom_pointrange() +
  geom_hline(yintercept = 0, lty = "dashed", color = "red") +
  coord_flip() +
  labs(y = "Difference in xenophobia between
       Bulgaria and Denmark
       (10-point Likert Scale)",
       x = "") +
  theme_minimal()
```
]]
..push-right[
.font90[

```r
ols_bi &lt;- lm_robust(imwbcnt ~ cntry, data = ESS, 
                    weights = pspwght)
ols_mult_1 &lt;- lm_robust(imwbcnt ~ cntry + eduyrs, 
                        data = ESS, weights = pspwght)
ols_mult_2 &lt;- lm_robust(imwbcnt ~ cntry + eduyrs + agea, 
                        data = ESS, weights = pspwght)
# Report results in a regression table
screenreg(list(ols_bi, ols_mult_1, ols_mult_2), 
          include.ci = FALSE, digits = 3)
```
]]]
.panel[.panel-name[Multiple OLS is additive!]
.left-column[
**Multiple OLS, so far:** Allows us to express an outcome as linear function of several continuous and categorical predictor variables. The predictors are adjusted/controlled for each other .alert[and additive].

.font70[
`\(\rightarrow\)` For a Bulgarian who is 20 and has 10 years of education, Model 3 predicts: 
`\(4.21 + 1.61 + (10\times -0.04) + (20 \times 0.01) = 5.62 \text{ Xeno}\)`

]]
.right-column[
.font90[



```
# 
# =======================================================
#                Model 1       Model 2       Model 3     
# -------------------------------------------------------
# (Intercept)       4.326 ***     4.909 ***     4.206 ***
#                  (0.071)       (0.213)       (0.237)   
# cntryBulgaria     1.680 ***     1.635 ***     1.608 ***
#                  (0.098)       (0.100)       (0.100)   
# eduyrs                         -0.043 **     -0.040 ** 
#                                (0.014)       (0.014)   
# agea                                          0.014 ***
#                                              (0.003)   
# -------------------------------------------------------
# R^2               0.113         0.116         0.128    
# Adj. R^2          0.113         0.116         0.127    
# Num. obs.      3330          3330          3330        
# RMSE              2.348         2.344         2.329    
# =======================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```

$$
\operatorname{\widehat{imwbcnt}} = 4.21 + 1.61(\operatorname{cntry}_{\operatorname{Bulgaria}}) - 0.04(\operatorname{eduyrs}) + 0.01(\operatorname{agea})
$$


]]]]

---
# But what if relations are conditional?

.panelset[
.panel[.panel-name[Plot]
.push-left[

.content-box-blue[
Two predictors `\(X_{1i}\)` and `\(X_{2i}\)` are **"conditional on each other"** or **"interact"**, when the association between the outcome `\(Y_{i}\)` and one of the predictors depends on values of the other.
]

- Education is a more negative predictor of xenophobia in Denmark than in Bulgaria. 
  + .backgrnote[That is, the association between education and xenophobia depends on the country people live in.]


- The difference in average xenophobia between Danes and Bulgarians is larger among better educated people.
  + .backgrnote[That is, the association between country and xenophobia depends on people's level of education.]
]
.push-right[
&lt;img src="11-Conditionals_files/figure-html/conditional1-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]]

.panel[.panel-name[Code]

```r
ggplot(data = ESS, aes(y = imwbcnt, x = eduyrs, color = cntry)) +
  geom_jitter(aes(size = pspwght), alpha = 1/8) +
  geom_smooth(method = "lm") +
  labs(y = "Immigration makes DK/BG \n a worse place to live",
       x = "Years of education") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  guides(size = FALSE)
```
]]

---
# Then specify them as *multiplicative*

`$$Y_{i} = \alpha + \beta_{1} X_{1} + \beta_{2}X_{2} + \color{red}{\beta_{3}(X_{1}\times X_{2})} + e_{i}$$`

.push-left[
.font90[

```r
ols_mult_1 &lt;- lm_robust(imwbcnt ~ cntry + eduyrs, 
                        data = ESS, weights = pspwght)
*ols_inter &lt;- lm_robust(imwbcnt ~ cntry*eduyrs,
                       data = ESS, weights = pspwght)
# Report results in a regression table
screenreg(list(ols_mult_1, ols_inter), 
          include.ci = FALSE, digits = 3)
# 
# ================================================
#                       Model 1       Model 2     
# ------------------------------------------------
# (Intercept)              4.909 ***     5.873 ***
#                         (0.213)       (0.279)   
# cntryBulgaria            1.635 ***    -0.375    
#                         (0.100)       (0.385)   
# eduyrs                  -0.043 **     -0.113 ***
#                         (0.014)       (0.019)   
# cntryBulgaria:eduyrs                   0.153 ***
#                                       (0.027)   
# ------------------------------------------------
# R^2                      0.116         0.127    
# Adj. R^2                 0.116         0.126    
# Num. obs.             3330          3330        
# RMSE                     2.344         2.330    
# ================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

--

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-9-1.png" width="75%" style="display: block; margin: auto;" /&gt;
- R *adds* an "interaction term", technically the product of the two interacted variables (i.e. `\(\text{Bulgaria} \times \text{Education}\)`).
- Thereby, multiple OLS processes the conditional relation in an additive way (aka "linearization").
]

---
# Then specify them as *multiplicative*

.push-left[

```r
ESS &lt;- ESS %&gt;% mutate(
    cntry_num = case_when(
      # Numerical cntry dummy variable,
      cntry == "Denmark" ~ 0,
      cntry == "Bulgaria" ~ 1),
    # Generate interaction term by hand
    intr_trm = cntry_num * eduyrs)

ESS %&gt;% 
  select(idno, cntry, cntry_num, eduyrs, intr_trm)
# # A tibble: 3,330 × 5
#     idno cntry    cntry_num eduyrs intr_trm
#    &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
#  1     2 Bulgaria         1     12       12
#  2    27 Bulgaria         1     17       17
#  3    37 Bulgaria         1      9        9
#  4    50 Bulgaria         1     12       12
#  5    70 Bulgaria         1     12       12
#  6    76 Bulgaria         1     12       12
#  7   137 Bulgaria         1      9        9
#  8   182 Bulgaria         1     17       17
#  9   208 Bulgaria         1     12       12
# 10   234 Bulgaria         1     17       17
# # … with 3,320 more rows
```
]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-11-1.png" width="75%" style="display: block; margin: auto;" /&gt;
- R *adds* an "interaction term", technically the product of the two interacted variables (i.e. `\(\text{Bulgaria} \times \text{Education}\)`).
- Thereby, multiple OLS processes the conditional relation in an additive way (aka "linearization").
]

---
# Then specify them as *multiplicative*

.push-left[
.font90[

```r
ols_inter2 &lt;- lm_robust(imwbcnt ~ cntry + eduyrs + intr_trm,
                       data = ESS, weights = pspwght)
# Report results in a regression table
screenreg(list(ols_inter, ols_inter2), 
          include.ci = FALSE, digits = 3)
# 
# ================================================
#                       Model 1       Model 2     
# ------------------------------------------------
# (Intercept)              5.873 ***     5.873 ***
#                         (0.279)       (0.279)   
# cntryBulgaria           -0.375        -0.375    
#                         (0.385)       (0.385)   
# eduyrs                  -0.113 ***    -0.113 ***
#                         (0.019)       (0.019)   
# cntryBulgaria:eduyrs     0.153 ***              
#                         (0.027)                 
# intr_trm                               0.153 ***
#                                       (0.027)   
# ------------------------------------------------
# R^2                      0.127         0.127    
# Adj. R^2                 0.126         0.126    
# Num. obs.             3330          3330        
# RMSE                     2.330         2.330    
# ================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-13-1.png" width="75%" style="display: block; margin: auto;" /&gt;
- R *adds* an "interaction term", technically the product of the two interacted variables (i.e. `\(\text{Bulgaria} \times \text{Education}\)`).
- Thereby, multiple OLS processes the conditional relation in an additive way (aka "linearization").
]

---
layout: true
class: clear
# Tricky interpretation .font70[The two conditional "Main terms"]

---
.push-left[
.font90[

```
# 
# ================================================
#                       Model 1       Model 2     
# ------------------------------------------------
# (Intercept)              4.909 ***     5.873 ***
#                         (0.213)       (0.279)   
# cntryBulgaria            1.635 ***    -0.375    
#                         (0.100)       (0.385)   
# eduyrs                  -0.043 **     -0.113 ***
#                         (0.014)       (0.019)   
# cntryBulgaria:eduyrs                   0.153 ***
#                                       (0.027)   
# ------------------------------------------------
# R^2                      0.116         0.127    
# Adj. R^2                 0.116         0.126    
# Num. obs.             3330          3330        
# RMSE                     2.344         2.330    
# ================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-15-1.png" width="75%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

`$$\beta_1\color{red}{|x_2=0} \text{ &amp; } \beta_2\color{red}{|x_1=0}$$`

`\(\rightarrow \beta_{\text{eduyrs}}\color{red}{|\text{Bulgaria} = 0},\)`

`\(\rightarrow \beta_{\text{Bulgaria}}\color{red}{|\text{eduyrs} = 0}.\)`
]

---

.push-left[
.font90[

```
# 
# ================================================
#                       Model 1       Model 2     
# ------------------------------------------------
# (Intercept)              4.909 ***     5.873 ***
#                         (0.213)       (0.279)   
# cntryBulgaria            1.635 ***    -0.375    
#                         (0.100)       (0.385)   
# eduyrs                  -0.043 **     -0.113 ***
#                         (0.014)       (0.019)   
# cntryBulgaria:eduyrs                   0.153 ***
#                                       (0.027)   
# ------------------------------------------------
# R^2                      0.116         0.127    
# Adj. R^2                 0.116         0.126    
# Num. obs.             3330          3330        
# RMSE                     2.344         2.330    
# ================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-17-1.png" width="75%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

`$$\beta_1\color{red}{|x_2=0} \text{ &amp; } \beta_2\color{red}{|x_1=0}$$`

`\(\rightarrow \beta_{\text{eduyrs}}\color{red}{|\text{Bulgaria} = 0}\)`: A year increase in education goes along with a decline of xenophobia by -0.113 scale points, .alert[if Bulgaria = 0]. `\(\rightarrow\)` .alert[In Denmark], a year increase in education ...

`\(\rightarrow \beta_{\text{Bulgaria}}\color{red}{|\text{eduyrs} = 0}.\)`
]

---

.push-left[
.font90[

```
# 
# ================================================
#                       Model 1       Model 2     
# ------------------------------------------------
# (Intercept)              4.909 ***     5.873 ***
#                         (0.213)       (0.279)   
# cntryBulgaria            1.635 ***    -0.375    
#                         (0.100)       (0.385)   
# eduyrs                  -0.043 **     -0.113 ***
#                         (0.014)       (0.019)   
# cntryBulgaria:eduyrs                   0.153 ***
#                                       (0.027)   
# ------------------------------------------------
# R^2                      0.116         0.127    
# Adj. R^2                 0.116         0.126    
# Num. obs.             3330          3330        
# RMSE                     2.344         2.330    
# ================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/conditional2-1.png" width="75%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

`$$\beta_1\color{red}{|x_2=0} \text{ &amp; } \beta_2\color{red}{|x_1=0}$$`

`\(\rightarrow \beta_{\text{eduyrs}}\color{red}{|\text{Bulgaria} = 0}\)`: A year increase in education goes along with a decline of xenophobia by -0.113 scale points, .alert[if Bulgaria = 0]. `\(\rightarrow\)` .alert[In Denmark], a year increase in education ...

`\(\rightarrow \beta_{\text{Bulgaria}}\color{red}{|\text{eduyrs} = 0}.\)`
]

---
layout: false
class: clear
# Solution: Rescale .font70[(e.g. mean center, or z-standardize)]

.push-left[

```r
ESS &lt;- ESS %&gt;% mutate(
    # Center education around the mean of education.
    mc_eduyrs = eduyrs - mean(eduyrs, na.rm = TRUE))

summary(ESS$mc_eduyrs)
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#   -4.24   -2.24   -1.24    0.00    2.76    7.76
```
]
.push-right[
&lt;img src="11-Conditionals_files/figure-html/conditional3-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
layout: true
class: clear
# Improved interpretation .font70[The two conditional "Main terms"]

---

.push-left[

```
# 
# ===================================================
#                          Model 1       Model 2     
# ---------------------------------------------------
# (Intercept)                 5.873 ***     4.378 ***
#                            (0.279)       (0.072)   
# cntryBulgaria              -0.375         1.650 ***
#                            (0.385)       (0.099)   
# eduyrs                     -0.113 ***              
#                            (0.019)                 
# cntryBulgaria:eduyrs        0.153 ***              
#                            (0.027)                 
# mc_eduyrs                                -0.113 ***
#                                          (0.019)   
# cntryBulgaria:mc_eduyrs                   0.153 ***
#                                          (0.027)   
# ---------------------------------------------------
# R^2                         0.127         0.127    
# Adj. R^2                    0.126         0.126    
# Num. obs.                3330          3330        
# RMSE                        2.330         2.330    
# ===================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-20-1.png" width="75%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

`$$\beta_1\color{red}{|x_2=0} \text{ &amp; } \beta_2\color{red}{|x_1=0}$$`

`\(\rightarrow \beta_{\text{eduyrs}}\color{red}{|\text{Bulgaria} = 0}\)`: A year increase in education goes along with a decline of xenophobia by -0.113 scale points, .alert[if Bulgaria = 0]. `\(\rightarrow\)` .alert[In Denmark], a year increase in education ...

`\(\rightarrow \beta_{\text{Bulgaria}}\color{red}{|\text{eduyrs} = 0}.\)`
]

---

.push-left[


```
# 
# ===================================================
#                          Model 1       Model 2     
# ---------------------------------------------------
# (Intercept)                 5.873 ***     4.378 ***
#                            (0.279)       (0.072)   
# cntryBulgaria              -0.375         1.650 ***
#                            (0.385)       (0.099)   
# eduyrs                     -0.113 ***              
#                            (0.019)                 
# cntryBulgaria:eduyrs        0.153 ***              
#                            (0.027)                 
# mc_eduyrs                                -0.113 ***
#                                          (0.019)   
# cntryBulgaria:mc_eduyrs                   0.153 ***
#                                          (0.027)   
# ---------------------------------------------------
# R^2                         0.127         0.127    
# Adj. R^2                    0.126         0.126    
# Num. obs.                3330          3330        
# RMSE                        2.330         2.330    
# ===================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-22-1.png" width="50%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

`$$\beta_1\color{red}{|x_2=0} \text{ &amp; } \beta_2\color{red}{|x_1=0}$$`

`\(\rightarrow \beta_{\text{eduyrs}}\color{red}{|\text{Bulgaria} = 0}\)`: A year increase in education goes along with a decline of xenophobia by -0.113 scale points, .alert[if Bulgaria = 0]. `\(\rightarrow\)` .alert[In Denmark], a year increase in education ...

`\(\rightarrow \beta_{\text{Bulgaria}}\color{red}{|\text{eduyrs} = 0}\)`: Bulgarians are, on average, 1.65 scale points more xenophobic than Danes, .alert[if education = 0]. `\(\rightarrow\)` .alert[Among persons with an average level of education], Bulgarians are ...

]

---
layout: true
class: clear
# Interpretation .font70[The "Interaction term" *alters* the main terms]

.push-left[
The interaction term, `\(\beta_3(X_{1i}\times X_{2i})\)`, can be interpreted in two ways

```
# 
# =====================================
#                          Model 1     
# -------------------------------------
# (Intercept)                 4.378 ***
#                            (0.072)   
# cntryBulgaria               1.650 ***
#                            (0.099)   
# mc_eduyrs                  -0.113 ***
#                            (0.019)   
# cntryBulgaria:mc_eduyrs     0.153 ***
#                            (0.027)   
# -------------------------------------
# R^2                         0.127    
# Adj. R^2                    0.126    
# Num. obs.                3330        
# RMSE                        2.330    
# =====================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]

---

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-23-1.png" width="66%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

1) When the variable `cntryBulgaria` increases by one unit, `\(\beta_{\text{Educ}}\)` increases by `\(\beta_{3}\)`. 
  + In Bulgaria, the association between education and xenophobia is `\(-0.113 + 0.153 = 0.04\)`.
  + The difference in `\(\beta_{\text{Educ}}\)` between Denmark and Bulgaria is 0.153.

]

---

.push-right[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-24-1.png" width="66%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;

2) When the variable `mc_eduyrs` increases by one unit, `\(\beta_{\text{cntryBulgaria}}\)` increases by `\(\beta_{3}\)`.
  + Among the best educated (i.e. 8 years more than the average), the xenophobia gap between Danes and Bulgarians is `\(-0.113 + 8 \times 0.153 = 1.111\)`
  + With every year of education, the average xenophobia gap between Danes and Bulgarians changes by 0.153.

]

---
layout: false
# Another example

.panelset[
.panel[.panel-name[Age and gender]
.left-column[
.font90[

```
# 
# ==================================
#                       Model 1     
# ----------------------------------
# (Intercept)              5.278 ***
#                         (0.075)   
# mc_eduyrs               -0.060 ** 
#                         (0.021)   
# gndrFemale              -0.097    
#                         (0.102)   
# mc_eduyrs:gndrFemale    -0.037    
#                         (0.029)   
# ----------------------------------
# R^2                      0.013    
# Adj. R^2                 0.012    
# Num. obs.             3330        
# RMSE                     2.478    
# ==================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]
.right-column[
&lt;img src="11-Conditionals_files/figure-html/conditional4-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Interpretation Main terms]

.left-column[
.font90[

```
# 
# ==================================
#                       Model 1     
# ----------------------------------
# (Intercept)              5.278 ***
#                         (0.075)   
# mc_eduyrs               -0.060 ** 
#                         (0.021)   
# gndrFemale              -0.097    
#                         (0.102)   
# mc_eduyrs:gndrFemale    -0.037    
#                         (0.029)   
# ----------------------------------
# R^2                      0.013    
# Adj. R^2                 0.012    
# Num. obs.             3330        
# RMSE                     2.478    
# ==================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]
.right-column[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-26-1.png" width="45%" style="display: block; margin: auto;" /&gt;
`\(\rightarrow \beta_{Educ}|\text{Female}=0\)`: Among men, an additional year of education is significantly associated with -0.06 scale points less xenophobia.

`\(\rightarrow \beta_{Female}|\text{Educ}=0\)`: At average levels of education, the gender gap in xenophobia is -0.097 but insignificant.
]]
.panel[.panel-name[Interpretation Interaction term]

.left-column[
.font90[

```
# 
# ==================================
#                       Model 1     
# ----------------------------------
# (Intercept)              5.278 ***
#                         (0.075)   
# mc_eduyrs               -0.060 ** 
#                         (0.021)   
# gndrFemale              -0.097    
#                         (0.102)   
# mc_eduyrs:gndrFemale    -0.037    
#                         (0.029)   
# ----------------------------------
# R^2                      0.013    
# Adj. R^2                 0.012    
# Num. obs.             3330        
# RMSE                     2.478    
# ==================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]
.right-column[
&lt;img src="11-Conditionals_files/figure-html/unnamed-chunk-28-1.png" width="45%" style="display: block; margin: auto;" /&gt;

1) The association between education and xenophobia among women is `\(-0.06 + -0.037= -0.097\)`. This is -0.037 more negative than the association among men, but this different in slopes is not significant.

2) With every year increase of education, the gender gap in xenophobia declines by -0.037. At two years more education than the average citizen, the gender gap is `\(-0.06 + 2\times -0.037= -0.134\)` scale points, but (probably) insignificant.


]]
.panel[.panel-name[Code]
.push-left[

```r
ols_inter &lt;- lm_robust(imwbcnt ~ mc_eduyrs*gndr,
                       data = ESS, weights = pspwght)
# Report results in a regression table
screenreg(list(ols_inter), 
          include.ci = FALSE, digits = 3)
```
]

.push-right[

```r
ggplot(data = ESS, aes(y = imwbcnt, x = mc_eduyrs, color = gndr)) +
  geom_jitter(aes(size = pspwght), alpha = 1/8) +
  geom_vline(xintercept = 0, color = "red") +
  geom_smooth(method = "lm", fullrange=TRUE) +
  labs(y = "Immigration makes DK/BG \n a worse place to live",
       x = "Years of education \n (centered around the mean)") +
  theme_minimal() +
  scale_x_continuous(limits = c(-5, 8), breaks = c(-4, -2, 0, 2, 4, 6, 8)) +
  theme(legend.position = "bottom") +
  guides(size = FALSE)
```
]]]

---

BREAK

---
# Control for potential confounders .font70[Easy ...]

.push-left[

```
# 
# ===================================================
#                          Model 1       Model 2     
# ---------------------------------------------------
# (Intercept)                 4.378 ***     3.789 ***
#                            (0.072)       (0.150)   
# cntryBulgaria               1.650 ***     1.625 ***
#                            (0.099)       (0.099)   
# mc_eduyrs                  -0.113 ***    -0.108 ***
#                            (0.019)       (0.018)   
# cntryBulgaria:mc_eduyrs     0.153 ***     0.150 ***
#                            (0.027)       (0.027)   
# gndrFemale                               -0.135    
#                                          (0.096)   
# agea                                      0.014 ***
#                                          (0.003)   
# ---------------------------------------------------
# R^2                         0.127         0.139    
# Adj. R^2                    0.126         0.137    
# Num. obs.                3330          3330        
# RMSE                        2.330         2.315    
# ===================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]

---
# Visualize!

.push-left[

```
# 
# ===================================================
#                          Model 1       Model 2     
# ---------------------------------------------------
# (Intercept)                 4.378 ***     3.789 ***
#                            (0.072)       (0.150)   
# cntryBulgaria               1.650 ***     1.625 ***
#                            (0.099)       (0.099)   
# mc_eduyrs                  -0.113 ***    -0.108 ***
#                            (0.019)       (0.018)   
# cntryBulgaria:mc_eduyrs     0.153 ***     0.150 ***
#                            (0.027)       (0.027)   
# gndrFemale                               -0.135    
#                                          (0.096)   
# agea                                      0.014 ***
#                                          (0.003)   
# ---------------------------------------------------
# R^2                         0.127         0.139    
# Adj. R^2                    0.126         0.137    
# Num. obs.                3330          3330        
# RMSE                        2.330         2.315    
# ===================================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]

.push-right[
.panelset[
.panel[.panel-name[Fictional data]
.font90[

```r
(fict_dat &lt;- tibble(
* # Repeat the vector -5:8, each element twice
* mc_eduyrs = rep(-5:8, each = 2),
* # Repeat DK/BG 14 times
* cntry = rep(c("Denmark", "Bulgaria"), 14),
  # Set controls to constant value
  gndr = "Female",
  agea = mean(ESS$agea, na.rm = TRUE)))
# # A tibble: 28 × 4
#    mc_eduyrs cntry    gndr    agea
#        &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;
#  1        -5 Denmark  Female  52.2
#  2        -5 Bulgaria Female  52.2
#  3        -4 Denmark  Female  52.2
#  4        -4 Bulgaria Female  52.2
#  5        -3 Denmark  Female  52.2
#  6        -3 Bulgaria Female  52.2
#  7        -2 Denmark  Female  52.2
#  8        -2 Bulgaria Female  52.2
#  9        -1 Denmark  Female  52.2
# 10        -1 Bulgaria Female  52.2
# # … with 18 more rows
```
]]
.panel[.panel-name[Predictions]
.font90[

```r
*(fict_dat &lt;- predict(
* ols_inter4, newdata = fict_dat,
* interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 28 × 7
#    mc_eduyrs cntry    gndr    agea   fit   lwr   upr
#        &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1        -5 Denmark  Female  52.2  4.91  4.64  5.19
#  2        -5 Bulgaria Female  52.2  5.79  5.55  6.02
#  3        -4 Denmark  Female  52.2  4.81  4.56  5.05
#  4        -4 Bulgaria Female  52.2  5.83  5.63  6.04
#  5        -3 Denmark  Female  52.2  4.70  4.48  4.92
#  6        -3 Bulgaria Female  52.2  5.87  5.69  6.06
#  7        -2 Denmark  Female  52.2  4.59  4.39  4.79
#  8        -2 Bulgaria Female  52.2  5.92  5.75  6.08
#  9        -1 Denmark  Female  52.2  4.48  4.30  4.66
# 10        -1 Bulgaria Female  52.2  5.96  5.80  6.11
# # … with 18 more rows
```
]]
.panel[.panel-name[Plot]
&lt;img src="11-Conditionals_files/figure-html/predictions-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Code]

```r
ggplot(data = fict_dat, aes(y = fit, x = mc_eduyrs)) +
  geom_ribbon(aes(ymin = lwr, ymax = upr, fill = cntry), alpha = 0.5) +
  geom_line(aes(color = cntry)) +
  labs(
    fill = "Country:", color = "Country:",
    title = "Predictions based on multiple OLS",
    x = "By mean-centered years of education
    (At average age and gender set to women)",
    y = "Predicted xenophobia") +
  theme_minimal() +
  theme(legend.position = "bottom")
```
]]]

---

Exercise

---
class: inverse
# Revised research question

.center[.font140[
Is socialism good at reducing poverty if combined with citizenship rights,&lt;br&gt;&lt;br&gt; but not good at it if under autocratic rule?
]]

&lt;br&gt;
.push-left[
&lt;img src="https://miro.medium.com/max/1280/1*8Y_EPw2a67TRRos3b24YlA.jpeg" width="90%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&lt;img src="https://almayasabdam.com/wp-content/uploads/2020/09/1496441134_communists.png" width="96%" style="display: block; margin: auto;" /&gt;
]



---
class: clear
layout: true
# Interaction of two continuous variables

---

.panelset[
.panel[.panel-name[OLS results]
.push-left[

```
# 
# ===========================================
#                                 Model 1    
# -------------------------------------------
# (Intercept)                      42.609 ***
#                                  (2.585)   
# mc_socialist                     -0.163    
#                                  (0.216)   
# mc_citizen_rights                -5.242 ***
#                                  (0.733)   
# mc_socialist:mc_citizen_rights    0.079 *  
#                                  (0.039)   
# -------------------------------------------
# R^2                               0.295    
# Adj. R^2                          0.280    
# Num. obs.                       146        
# RMSE                             30.061    
# ===========================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]]
.panel[.panel-name[Code]

```r
# Same data as Lecture 2 
Dat &lt;- Dat %&gt;% mutate( # Mean-center predictors
  mc_socialist = socialist - mean(socialist, na.rm = TRUE),
  mc_citizen_rights = citizen_rights - mean(citizen_rights, na.rm = TRUE))

# Multiple OLS
ols_inter &lt;- lm_robust(poverty ~ mc_socialist*mc_citizen_rights, data = Dat)

# Regression table
screenreg(list(ols_inter), include.ci = FALSE, digits = 3)
```
]]

---

.panelset[
.panel[.panel-name[OLS results]
.push-left[

```
# 
# ===========================================
#                                 Model 1    
# -------------------------------------------
# (Intercept)                      42.609 ***
#                                  (2.585)   
# mc_socialist                     -0.163    
#                                  (0.216)   
# mc_citizen_rights                -5.242 ***
#                                  (0.733)   
# mc_socialist:mc_citizen_rights    0.079 *  
#                                  (0.039)   
# -------------------------------------------
# R^2                               0.295    
# Adj. R^2                          0.280    
# Num. obs.                       146        
# RMSE                             30.061    
# ===========================================
# *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05
```
]
.push-right[
`\(\beta_{\text{Socialism}}|\text{Citizen Rights}=0\)`: At average levels of citizenship rights, socialism is not significantly related to declines in poverty.

`\(\beta_{\text{Citizen Rights}}|\text{Socialism}=0\)`: At average levels of socialism, a unit increase in citizenship rights is significantly related to a -5.242 percentage point decline in poverty.

`$$\beta_{\text{Socialism} \times \text{Citizen Rights}}$$`
1) With every unit more citizenship rights, socialism gets 0.079 percentage points worse at being related to declines in poverty.

2) With every additional year of socialism, citizenship rights are 0.079 percentage points less associated with declines in poverty.

]]
.panel[.panel-name[Code]

```r
# Same data as Lecture 2 
Dat &lt;- Dat %&gt;% mutate( # Mean-center predictors
  mc_socialist = socialist - mean(socialist, na.rm = TRUE),
  mc_citizen_rights = citizen_rights - mean(citizen_rights, na.rm = TRUE))

# Multiple OLS
ols_inter &lt;- lm_robust(poverty ~ mc_socialist*mc_citizen_rights, data = Dat)

# Regression table
screenreg(list(ols_inter), include.ci = FALSE, digits = 3)
```
]
.panel[.panel-name[Predictions]
.push-left[
.font90[

```r
summary(Dat$mc_socialist)
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#    -6.7    -6.7    -6.7     0.0    -1.7    66.3
summary(Dat$mc_citizen_rights)
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#   -7.62   -2.62    0.38    0.00    3.38    4.38
*(fict_dat &lt;- tibble( # Choose "representative" values of
* # x1 and x2 at which you wish to predict
  # Repeat min, mean, and max each four times,
  mc_socialist = rep(c(-6, 0, 60), each = 3),
  # Repeat min, mean max four times.
  mc_citizen_rights = rep(c(-7, 0, 4), 3)))
# # A tibble: 9 × 2
#   mc_socialist mc_citizen_rights
#          &lt;dbl&gt;             &lt;dbl&gt;
# 1           -6                -7
# 2           -6                 0
# 3           -6                 4
# 4            0                -7
# 5            0                 0
# 6            0                 4
# 7           60                -7
# 8           60                 0
# 9           60                 4
```
]]
.push-right[
.font90[

```r
(fict_dat &lt;- predict(
  ols_inter, newdata = fict_dat,
  interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 9 × 5
#   mc_socialist mc_citizen_rights   fit    lwr   upr
#          &lt;dbl&gt;             &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
# 1           -6                -7  83.6  70.1   97.1
# 2           -6                 0  43.6  38.2   48.9
# 3           -6                 4  20.7  14.3   27.2
# 4            0                -7  79.3  66.9   91.7
# 5            0                 0  42.6  37.5   47.7
# 6            0                 4  21.6  14.9   28.4
# 7           60                -7  36.4  10.5   62.3
# 8           60                 0  32.8   5.95  59.7
# 9           60                 4  30.8 -11.4   73.1
```
]]
.panel[.panel-name[Plots]
.push-left[
&lt;img src="11-Conditionals_files/figure-html/predictions2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.push-right[
&lt;img src="11-Conditionals_files/figure-html/predictions3-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Code]
.push-left[
.font90[

```r
ggplot(data = fict_dat, aes(y = fit, x = mc_socialist)) +
  geom_ribbon(aes(ymin = lwr, ymax = upr, 
                  fill = factor(mc_citizen_rights)), alpha = 0.5) +
  geom_line(aes(color = factor(mc_citizen_rights))) +
  labs(
    fill = "Mean-centered citizenship rights:", 
    color = "Mean-centered citizenship rights:",
    title = "Predictions based on multiple OLS",
    x = "By mean-centered years of socialist history",
    y = "Predicted Extreme poverty 
    among population") +
  theme_minimal() +
  theme(legend.position = "bottom")
```
]]
.push-right[
.font90[

```r
ggplot(data = fict_dat, aes(y = fit, x = mc_citizen_rights)) +
  geom_ribbon(aes(ymin = lwr, ymax = upr, 
                  fill = factor(mc_socialist)), alpha = 0.5) +
  geom_line(aes(color = factor(mc_socialist))) +
  labs(
    fill = "Mean-centered socialist history:", 
    color = "Mean-centered socialist history:",
    title = "Predictions based on multiple OLS",
    x = "By mean-centered citizenship rights",
    y = "Predicted Extreme poverty 
    among population") +
  theme_minimal() +
  theme(legend.position = "bottom")
```
]]]
.panel[.panel-name[Potential theory]

.left-column[
&lt;img src="https://www.aljazeera.com/wp-content/uploads/2022/11/000_32MK2ZL.jpg?resize=770%2C513" width="100%" style="display: block; margin: auto;" /&gt;
]
.right-column[
- Among the autocrats, better catch a socialist.

- Among the democrats, socialists aren't performing significantly different in termsw of fighting extreme poverty.

`\(\rightarrow\)` Most importantly: .alert[Be democratic!]

]]]]

---
layout: false
class: inverse
# Today's general lessons

1. 





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../template/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
