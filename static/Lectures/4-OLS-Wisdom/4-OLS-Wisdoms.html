<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Multiple Regression &amp;    Fundamentals of Causal Inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="Merlin Schaeffer  Department of Sociology" />
    <meta name="date" content="2023-09-27" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="../template/Merlin169.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Multiple Regression &amp; <br><br> Fundamentals of Causal Inference
]
.subtitle[
## 4 OLS from a assumptions to visualization
]
.author[
### Merlin Schaeffer<br> Department of Sociology
]
.date[
### 2023-09-27
]

---



# Goal of empirical sociology

.font130[.center[Use data to .alert[discover patterns], &lt;br&gt; and the social mechanisms that bring them about.]]

&lt;img src="https://liu.se/-/media/istock-501261958.jpg?mw=1120&amp;mh=1120&amp;hash=DA8977CCE6A6E600AE80A40CFEE771C9" width="70%" style="display: block; margin: auto;" /&gt;
---
class: inverse
# Today's schedule

1. **Today's research question**: Colonialism and poverty
  
2. **OLS assumptions**
  + No outliers
  + Linearity
  
3. **Categorical predictors**
  + Dummy coding
  
4. **Binary outcomes**
  + Linear probability model (LPM)
  
5. **Visualizing regression**
  + Coefficient plots
  + Model predictions
  
---
class: inverse
# Colonial legacy

.push-left[
&lt;img src="https://cdn.cfr.org/sites/default/files/styles/open_graph_article/public/image/2020/01/France-Macron-Pau-Summit-G5-Sahel.jpg?h=63648819" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.push-right[
&lt;img src="https://en.natmus.dk/typo3temp/assets/images/csm_neky-holbech-16x9_b72c084303_2836164db1.jpg" width="80%" style="display: block; margin: auto;" /&gt;

&lt;img src="https://ichef.bbci.co.uk/news/976/cpsprodpb/6E2E/production/_113460282_mediaitem113460280.jpg" width="80%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse
# Today's research questions

.left-column[
.font130[Is poverty lower in countries that have been independent longer?]

.font130[How do different colonial legacies compare to one another?]
]

.right-column[
.font130[.center[Colonial empires 1945]]
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Colonization_1945.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[*Source*: [.white[Wikipedia]](https://en.wikipedia.org/wiki/File:World_1914_empires_colonies_territory.PNG)]]

---
# Preparations

.panelset[
.panel[.panel-name[Packages for today's session]

```r
pacman::p_load(
  tidyverse, # Data manipulation,
  ggplot2, # beautiful figures,
  democracyData, # download democracy datasets used in the scholarly literature.
  wbstats, # download data from Worldbank. Tremendous source of global socio-economic data.
  estimatr, # OLS with robust SE,
  modelsummary) # regression tables with nice layout,
```
]
.panel[.panel-name[Get WB data]

```r
(Dat &lt;- wb_data("SI.POV.DDAY", # Download poverty data: &lt;$2.15 per day,
                start_date = 2002, end_date = 2022) %&gt;%
   rename(poverty = SI.POV.DDAY) %&gt;% # rename poverty variable,
   select(country, date, poverty) %&gt;% # Keep only 3 variables
   drop_na(poverty) %&gt;% group_by(country) %&gt;% # Group by country,
   filter(date == max(date)) %&gt;% # Keep the most recent data per country.
   mutate(date = as.numeric(date)) %&gt;% ungroup())
# # A tibble: 162 × 3
#    country     date poverty
#    &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
#  1 Albania     2020     0  
#  2 Algeria     2011     0.5
#  3 Angola      2018    31.1
#  4 Argentina   2021     1  
#  5 Armenia     2021     0.5
#  6 Australia   2018     0.5
#  7 Austria     2020     0.7
#  8 Azerbaijan  2005     0  
#  9 Bangladesh  2022     9.6
# 10 Belarus     2020     0  
# # ℹ 152 more rows
```
]]

---
# Colonial legacy

.panelset[
.panel[.panel-name[A study]

.push-left[
&lt;img src="./img/SocialForces.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&lt;img src="./img/Colonial.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: Lange and Dawson (2009)]]
]
]

.panel[.panel-name[Its data]

.push-left[
&lt;img src="./img/Colonial2.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&lt;img src="./img/Colonial3.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: Lange and Dawson (2009)]]
]]

.panel[.panel-name[Coding colonial powers]
.font90[

```r
Dat &lt;- Dat %&gt;% 
  mutate(
    colonizer = case_when(
      str_detect(country, "Algeria|Benin|Burkina Faso|Cambodia|Central African Republic|Chad") |
        str_detect(country, "Djibouti|Gabon|Guinea|Haiti|Laos|Lebanon|Madagascar|Mali|Congo, Rep.|Cote D'Ivoire") | 
        str_detect(country, "Mauritania|Niger|Senegal|Syria|Togo|Tunisia|Vietnam") ~ "France", # France
      str_detect(country, "Angola|Brazil|Mozambique|Guinea-Bissau") ~ "Portugal", # Portugal
      str_detect(country, "Argentina|Bolivia|Chile|Colombia|Costa Rica|Cuba|Dominican Republic|Ecuador") |
        str_detect(country, "El Salvador|Guatemala|Honduras|Mexico|Nicaragua|Panama|Paraguay|Peru") |
        str_detect(country, "Uruguay|Venezuela") ~ "Spain", # Spain
      str_detect(country, "Bahrain|Bangladesh|Botswana|Cyprus|Egypt|Fiji") |
        str_detect(country, "Gambia|Ghana|Guyana|India|Iraq|Jamaica|Jordan|Kenya|Kuwait") |
        str_detect(country, "Lesotho|Malawi|Malaysia|Mauritius|Myanmar|Nigeria|Oman") | 
        str_detect(country, "Pakistan|Qatar|Sierra Leone|Singapore|South Africa") | 
        str_detect(country, "Sri Lanka|Sudan|Swaziland|Tanzania|Trinidad/Tobago|Uganda") | 
        str_detect(country, "United Arab Emirates|Yemen|Zambia|Zimbabwe") ~ "Britain", # Britain
      # Australia, Canada, Israel, New Zealand, United States; left out as settler societies
      str_detect(country, "Burundi|Congo, Dem. Rep.|Rwanda") ~ "Belgium")) # Belgium
      # str_detect(country, "Liberia|Philippines") ~ "USA", # USA
      # str_detect(country, "Libya|Somalia") ~ "Italy", # Italy
      # str_detect(country, "Indonesia") ~ "Holland", # Holland
      # str_detect(country, "Namibia") ~ "South Africa", # Holland
      # str_detect(country, "Korea|Taiwan") ~ "Japan")) # Japan
```
]]

.panel[.panel-name[Plot Colonizer]
&lt;img src="4-OLS-Wisdoms_files/figure-html/col-powers-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.panel[.panel-name[Coding independence]
.font60[

```r
Dat &lt;- Dat %&gt;% 
  mutate(
    years_indep = case_when(
      is.na(colonizer) ~ as.numeric(NA),
      country == "United States" ~ date - 1783, country == "Haiti" ~ date - 1804, 
      country == "Paraguay" ~ date - 1811, country == "Chile" ~ date - 1818,
      str_detect(country, "Argentina|Bolivia|Colombia") ~ date - 1819,
      str_detect(country, "Costa Rica|Dominican Republic|Mexico|Nicaragua|Panama|El Salvador|Guatemala|Honduras|Venezuela") ~ date - 1821,
      str_detect(country, "Brazil|Ecuador") ~ date - 1822,
      country == "Peru" ~ date - 1824, country == "Uruguay" ~ date - 1828,
      country == "Cuba" ~ date - 1899, country == "Australia" ~ date - 1901,
      country == "New Zealand" ~ date - 1907, country == "South Africa" ~ date - 1910,
      country == "Egypt" ~ date - 1922, country == "Iraq" ~ date - 1932,
      str_detect(country, "Korea|Taiwan|Vietnam") ~ date - 1945,
      str_detect(country, "Lebanon|Philippines|Syria") ~ date - 1946,
      str_detect(country, "Bangladesh|Pakistan|India|Liberia") ~ date - 1947,
      str_detect(country, "Myanmar|Israel|Jordan|Sri Lanka") ~ date - 1948,
      country == "Indonesia" ~ date - 1949, country == "Libya" ~ date - 1951,
      str_detect(country, "Cambodia|Loas") ~ date - 1954,
      str_detect(country, "Morocco|Sudan|Tunisia") ~ date - 1956,
      str_detect(country, "Malaysia|Ghana") ~ date - 1957,
      country == "Guinea" ~ date - 1958, country == "Singapore" ~ date - 1959,
      str_detect(country, "Benin|Burkina Faso|Central African Republic|Chad|Congo, Dem. Rep.|Congo, Rep.|Code D'Ivoire|Mali|Mauritania|Niger|Nigeria|Senegal|Gabon|Somalia|Togo") ~ date - 1960,
      str_detect(country, "Kuwait|Sierra Leone|Tanzania") ~ date - 1961,
      str_detect(country, "Algeria|Burundi|Rwanda|Jamaica|Trinidad/ Tobago|Uganda") ~ date - 1962,
      country == "Kenya" ~ date - 1963,
      str_detect(country, "Malawi|Zambia") ~ date - 1964,
      str_detect(country, "Gambia|Zimbabwe") ~ date - 1965,
      str_detect(country, "Botswana|Lesotho|Guyana") ~ date - 1966,
      str_detect(country, "Canada|Yemen") ~ date - 1967,
      str_detect(country, "Mauritius|Swaziland") ~ date - 1968,
      country == "Fiji" ~ date - 1970,
      str_detect(country, "Bahrain|Oman|Qatar|United Arab Emirates") ~ date - 1971,
      country == "Guinea-Bissau" ~ date - 1974,
      str_detect(country, "Angola|Mozambigue|Papua New Guinea") ~ date - 1975,
      country == "Djibouti" ~ date - 1977, 
      country == "Namibia" ~ date - 1990))
```
]]

.panel[.panel-name[Plot indep.]
&lt;img src="4-OLS-Wisdoms_files/figure-html/pov-indep-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]

---
# Poverty and years of independence

.left-column[.font90[

```r
# Estimate OLS regression
ols &lt;- lm_robust(
  poverty ~ years_indep, 
  data = Dat)
# Regression table
modelsummary(
  list("Poverty" = ols), stars = TRUE,
  gof_map = c("nobs", "r.squared"))
```

&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Poverty &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31.146*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (4.262) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; years_indep &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; −0.134*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.024) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 71 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.175 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; + p &amp;lt; 0.1, * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;


]]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/indep-world-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# OLS assumptions

---
class: clear
# OLS Assumptions

.left-column[
.content-box-blue[
1. **No outliers**
2. **Linearity**
3. Homoscedasticity; don't worry: `lm_robust()`.
4. Independent observations.

`\(\rightarrow\)` Scatter plots!
]]

.right-column[
&lt;iframe src='https://seeing-theory.brown.edu/regression-analysis/index.html#section1' width='700' height='580' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
# Outlier 

.left-column[
- The gray dotted line is our OLS line.

- **Leverage:** Case has strong influence on regression line; `\(x_i\)` is far from `\(\bar{x}\)`.
  

- **Z-standardized residuals:** case far from regression line.
  + Haiti with poverty of 29.2%.


```r
# Re-estimate model using lm(),
lm(poverty ~ years_indep, 
   data = Dat) %&gt;%
  # The best outlier plot.
* plot(., which = 5)
```
]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---
# An artificial outlier
.panelset[
.panel[.panel-name[Let's create an outlier]

```r
Dat_outl &lt;- Dat %&gt;%
  mutate( # Let's create an outlier:
    years_indep = case_when(
      country == "Sweden" ~ 500, # years of independence
      TRUE ~ years_indep),
    poverty = case_when(
      country == "Sweden" ~ 99, # 99% poverty
      TRUE ~ poverty))
```
]

.panel[.panel-name[OLS]
.left-column[.font90[

```r
# Estimation
ols_outl &lt;- lm_robust( 
  poverty ~ years_indep, 
  data = Dat_outl)
# Regression table
modelsummary(
  list("Poverty" = ols_outl), stars = TRUE,
  gof_map = c("nobs", "r.squared"))
```

&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Poverty &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 20.873* &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (9.019) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; years_indep &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; −0.014 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.098) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 72 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.002 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; + p &amp;lt; 0.1, * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;


]]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/Sweden-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Outlier analysis]
.left-column[
- **Leverage:** case has strong influence on regression line.
  
- **Z-standardized residuals:** case far from regression line.

- **Cook's D**: Bu how many standardized residuals would `\(\sum{\bar{y}}\)` change, if case `\(i\)` was deleted?


```r
# Re-estimate model using lm(),
lm(poverty ~ years_indep, 
   data = Dat_outl) %&gt;%
  # The best outlier plot.
* plot(., which = 5)
```
]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-18-1.png" width="75%" style="display: block; margin: auto;" /&gt;
]
]]

---
# Linearity

.left-column[
- The gray dotted line is our regression model.

- The red line should ideally be the same.

- .alert[In our example, the linearity assumption doesn't perfectly hold, but seems overall OK.]


```r
# Re-estimate model using lm(),
lm(poverty ~ years_indep, 
   data = Dat) %&gt;%
  # The best linearity plot.
* plot(., which = 1)
```
]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---
# Linearity .font70[And our outlier ...]

.left-column[
- The gray dotted line is our regression model.

- The red line should ideally be the same.


```r
# Re-estimate model using lm(),
lm(poverty ~ years_indep, 
   data = Dat_outl) %&gt;%
  # The best linearity plot.
  plot(., which = 1)
```
]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# Categorical predicators

---
# Categorical predicators

.panelset[
.panel[.panel-name[Scatter plot]

.left-column[
.content-box-green[
1. At which `\(\hat{Y}\)` does the regression line pass through the cloud of countries colonized by Britain?
2. At which `\(\hat{Y}\)` does the regression line pass through the cloud of countries colonized by Belgium?
3. What does this suggest about the slope `\(\hat{\beta}\)`?
]]
.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/categorical-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]

.panel[.panel-name[Dummy coding]

.push-left[
`$$x=
  \begin{cases}
    1, &amp; \text{if condition is met} \\
    0 &amp; \text{otherwise}
  \end{cases}$$`

Contintent                       | Belgium | France | ...
---------------------------------|----|----|----
Burundi                 | 1  | 0  | 0 
Rwanda                 | 1  | 0  | 0
...                 | 1  | 0  | 0
Cambodia                          | 0  | 1  | 0  
Algeria                          | 0  | 1  | 0
...                          | 0  | 1  | 0
Reference &lt;br&gt; .backgrnote[(Britain)] | 0  | 0  | 0
]

.push-right[
&lt;img src="4-OLS-Wisdoms_files/figure-html/categorical2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]

.panel[.panel-name[How it's done in R]
.push-left[.font80[

```r
# R recognizes categorical variables automatically,
# if they are factor or character vectors.
ols_2 &lt;- lm_robust(poverty ~ colonizer, data = Dat)
# Regression table
modelsummary(
  list("Poverty" = ols_2), stars = TRUE,
  coef_rename = c("colonizerFrance" = "France", 
                  "colonizerBelgium" = "Belgium",
                  "colonizerPortugal" = "Portugal", 
                  "colonizerSpain" = "Spain"),
  gof_map = c("nobs", "r.squared"))
```
]
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-21-1.png" width="75%" style="display: block; margin: auto;" /&gt;
]
.push-right[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Poverty &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.541*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (3.996) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; France &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.654 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.012) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Spain &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; −15.988*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (4.085) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Belgium &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 42.792*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.677) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Portugal &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 17.559 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (20.424) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 75 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.299 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; + p &amp;lt; 0.1, * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;


]]

.panel[.panel-name[Interpretation]
.push-left[.font90[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Poverty &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.541*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (3.996) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; France &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.654 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.012) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Spain &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; −15.988*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (4.085) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Belgium &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 42.792*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.677) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Portugal &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 17.559 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (20.424) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 75 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.299 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; + p &amp;lt; 0.1, * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;


]]
.push-right[


$$
`\begin{aligned}
\operatorname{\widehat{poverty}} &amp;= 19.54 + 3.65(\operatorname{colonizer}_{\operatorname{France}})\ - \\
&amp;\quad 15.99(\operatorname{colonizer}_{\operatorname{Spain}}) + 42.79(\operatorname{colonizer}_{\operatorname{Belgium}})\ + \\
&amp;\quad 17.56(\operatorname{colonizer}_{\operatorname{Portugal}})
\end{aligned}`
$$


- When France = 0, Belgium = 0, Spain = 0, and Portugal = 0, then poverty is on average 19.54%.&lt;br&gt; `\(\rightarrow\)` Average poverty across countries colonized by Britain: 19.54%.

- Across countries colonized by France, poverty is on average 3.65% higher than among those colonized by Britain; yet this difference is statistically not significant/systematic (could be the result of randomness).
  + Across countries colonized by France, poverty is thus: `\(19.54\% + 3.65\% = 23.19\%\)`.
]]]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://cdn.dribbble.com/users/10549/screenshots/9890798/media/f38f0e4d71d9763c7533641d2418b35b.png?compress=1&amp;resize=1200x900&amp;vertical=top" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;

&lt;iframe src='exercise1.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: inverse middle center
# Binary outcomes

---
class: clear
# LPM versus Generalized Linear Models (GLM)

.left-column[
Using OLS to predict a binary outcome (0 = "No" / 1 = "Yes") yields the so-called *Linear Probability Model (LPM)*. 

LPMs predict the probability that the outcome equals 1 `\(\hat{\text{Pr}}(y_i = 1|x_{i})\)`.

LPMs violate the linearity assumption and can thus predict `\(\hat{\text{Pr}}(y_i = 1|x_{i}) &lt; 0\)`, or `\(\hat{\text{Pr}}(y_i = 1|x_{i}) &gt;1\)`. &lt;br&gt; This is controversial!
]


.right-column[
&lt;img src="http://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1523361626/linear_vs_logistic_regression_h8voek.jpg" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: [datacamp: Logistic Regression in R Tutorial](https://www.datacamp.com/community/tutorials/logistic-regression-R)]]
]

---
# Logistic regression .font70[GLM for binary outcomes]

.push-left[
`$$\begin{align*}
\text{logit}(y_{i}) &amp;= \alpha + \beta x, \\
y_{i} &amp;= \text{logit}^{-1}(\alpha + \beta x) \\
&amp; = \text{logistic}(\alpha + \beta x) \\
&amp;= \frac{1}{1+e^{-(\alpha + \beta x)}}.
\end{align*}$$`



.font90[
| `\(\alpha + \beta x\)`  | `\(e^{(\alpha + \beta x)}\)` | `\(\frac{1}{e^{(\alpha + \beta x)}} \color{gray}{= e^{-(\alpha + \beta x)}}\)` | `\(\frac{1}{1 + e^{(\alpha + \beta x)}}\)` | `\(\frac{1}{1 +e^{-(\alpha + \beta x)}}\)` | 
|--------------------:|-------------------------:|-------------------------------------------------------------:|---------------------------------------:|---------------------------------------:|
|        -2           | 0.135                    | 7.389                                                        | 0.881                                  | 0.119                                  | 
|        -1           | 0.368                    | 2.718                                                        | 0.731                                  | 0.269                                  | 
|         0           | 1                        | 1                                                            | 0.5                                    | 0.5                                    | 
|         1           | 2.718                    | 0.368                                                        | 0.269                                  | 0.731                                  | 
|         2           | 7.389                    | 0.135                                                        | 0.119                                  | 0.881                                  |

]]

.push-right[
We need a link function `\(g^{-1}\)` that maps/projects the results of our linear model to the range 0 to 1. One option is the sigmoid (i.e., s-shaped) *logistic* function, with its inverse the *logit* (logged odds):

&lt;img src="4-OLS-Wisdoms_files/figure-html/Logit-fun-1.png" width="80%" style="display: block; margin: auto;" /&gt;

.backgrnote[
Alternatives are the probit or cloglog link functions; results compared to logit hardly ever differ in meaningful ways.]
]

---
class: middle center

We accept the linearity problem of LPMs, because GLMs (e.g. logistic regression) come with many other problems (Breen, Karlson, and Holm, 2018).

.alert[We use Linear Probability Models to predict binary outcomes.]

If you have a categorical outcome, make sure to code it 0/1.

---
class: inverse middle center
# Visualizing regression models

---
class: clear
# (1) Coefficient plots

.panelset[
.panel[.panel-name[Preparation]

```r
(plotdata &lt;- lm_robust(poverty ~ colonizer, data = Dat) %&gt;%
*  tidy() %&gt;% # Turn results into a tibble,
   mutate( # Rename variables for the plot.
     term = case_when(
       term == "colonizerFrance" ~ "France",
       term == "colonizerSpain" ~ "Spain",
       term == "colonizerBelgium" ~ "Belgium",
       term == "colonizerPortugal" ~ "Portugal",
       term == "(Intercept)" ~ "Intercept \n (Britain)")) %&gt;%
   filter(term != "Intercept \n (Britain)"))
#       term estimate std.error statistic  p.value conf.low conf.high df outcome
# 1   France     3.65      6.01     0.608 5.45e-01    -8.34     15.65 70 poverty
# 2    Spain   -15.99      4.08    -3.914 2.08e-04   -24.14     -7.84 70 poverty
# 3  Belgium    42.79      6.68     6.409 1.46e-08    29.48     56.11 70 poverty
# 4 Portugal    17.56     20.42     0.860 3.93e-01   -23.18     58.29 70 poverty
```
]

.panel[.panel-name[Plotting]

```r
ggplot(data = plotdata, aes(y = estimate, 
                            # Order by effect size
                            x = reorder(term, estimate))) +
  geom_hline(yintercept = 0, color = "red", lty = "dashed") +
  # Point with confidence interval,
* geom_pointrange(aes(min = conf.low, max = conf.high)) +
* coord_flip() + # Flip Y- &amp; X-Axis,
  labs(title = "Regression of poverty",
       x = "Colonizer",
       y = "Difference in poverty compared to countries colonized by Britain") +
  theme_minimal()
```
]
.panel[.panel-name[Plot]
.push-left[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.push-right[
&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Poverty &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.541*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (3.996) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; France &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3.654 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.012) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Spain &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; −15.988*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (4.085) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Belgium &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 42.792*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (6.677) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Portugal &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 17.559 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (20.424) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 75 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.299 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; + p &amp;lt; 0.1, * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;
&lt;/table&gt;


]]]

---
# (2) Model predictions

.panelset[
.panel[.panel-name[OLS model]
.push-left[

```r
(ols &lt;- lm_robust(poverty ~ years_indep, data = Dat))
#             Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper DF
# (Intercept)   31.146     4.2621    7.31 3.67e-10   22.644  39.6492 69
# years_indep   -0.134     0.0244   -5.49 6.14e-07   -0.183  -0.0854 69
```
]
.push-right[
&lt;img src="4-OLS-Wisdoms_files/figure-html/Coefplot2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]
.panel[.panel-name[Predictions]
.push-left[
**Step 1**: Generate fictional data of `\(x\)` with theoretically informative values.
.font90[

```r
(fict_dat &lt;- tibble(years_indep = 1:500))
# # A tibble: 500 × 1
#    years_indep
#          &lt;int&gt;
#  1           1
#  2           2
#  3           3
#  4           4
#  5           5
#  6           6
#  7           7
#  8           8
#  9           9
# 10          10
# # ℹ 490 more rows
```
]]
.push-right[
**Step 2**: What `\(\hat{y}\)` does our OLS model predict for the fictional data?
.font90[

```r
*(fict_dat &lt;- predict(
* object = ols,
* newdata = fict_dat,
* interval = "confidence", level = 0.95)$fit %&gt;%
   as_tibble() %&gt;% # Turn into a tibble, then
   bind_cols(fict_dat, .)) # Add to the synthetic data.
# # A tibble: 500 × 4
#    years_indep   fit   lwr   upr
#          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#  1           1  31.0  22.6  39.5
#  2           2  30.9  22.5  39.3
#  3           3  30.7  22.4  39.1
#  4           4  30.6  22.3  38.9
#  5           5  30.5  22.2  38.8
#  6           6  30.3  22.1  38.6
#  7           7  30.2  22.0  38.4
#  8           8  30.1  21.9  38.2
#  9           9  29.9  21.8  38.0
# 10          10  29.8  21.8  37.9
# # ℹ 490 more rows
```
]]]
.panel[.panel-name[Visualization]
.push-left[.font90[

```r
ggplot(data = fict_dat, aes(y = fit, x = years_indep)) +
  geom_vline(xintercept = c(34, 236), # Red reference lines
             color = "red", lty = "dashed") +
  geom_ribbon(aes(ymin = lwr, ymax = upr), # 95% Conf. Int.
              alpha = 0.5) +
  geom_line() + # The OLS line
  labs(
    title = "Predictions based on regression of extreme poverty",
    x = "By years since independence",
    y = "Predicted average of extreme poverty") +
  theme_minimal()
```
]]
.push-right[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]]]

---
# Learning goal achieved!

.left-column[
.font130[Is poverty lower in countries that have been independent longer?]

.font130[How do different colonial legacies compare to one another?]
]

.right-column[
&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-35-1.png" width="60%" style="display: block; margin: auto;" /&gt;

&lt;img src="4-OLS-Wisdoms_files/figure-html/unnamed-chunk-36-1.png" width="60%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://cdn.dribbble.com/users/10549/screenshots/9890798/media/f38f0e4d71d9763c7533641d2418b35b.png?compress=1&amp;resize=1200x900&amp;vertical=top" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;

&lt;iframe src='exercise2.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse
# Today's general lessons

1. Outliers can have a significant impact on the results of OLS regression. Cook's D statistic is a useful tool to identify these outliers.
2. OLS assumes an approximately linear relationship between the outcome and predictor variables, specifically for continuous predictors. It is important to verify whether this assumption holds true in your specific case. However, if your predictor is categorical, you do not need to be concerned about this assumption.
3. When using a categorical variable as a predictor in a regression analysis, it is typically dummy coded. This coding allows us to determine the average difference in the outcome between each category and a reference group.
4. R automatically recognizes categorical or factor variables and performs dummy coding for OLS regression. The first category is assigned as the reference group.
5. Coefficient plots are commonly used to visualize OLS regression results. 
6. Additionally, it is beneficial to visualize the model's predictions for hypothetical data points, especially when dealing with a continuous predictor.

---
# Today's (important) functions

- After `lm()`, `plot(YOUR_MODELOBJECT, which = 5)` helps to identify outlier.
- After `lm()`, `plot(YOUR_MODELOBJECT, which = 1)` helps to test, whether the linearity assumption is violated.
- `tidy()` Turns OLS regression results into a tibble.
- `predict()` Can be applied to fictional data to predict `\(\hat{Y}\)` based on your estimated OLS regression. 

---
# References

.font80[
Breen, R., K. B. Karlson, and A. Holm (2018). "Interpreting and Understanding Logits, Probits, and
Other NonLinear Probability Models". In: _Annual Review of Sociology_, pp. 39-54.

Lange, M. and A. Dawson (2009). "Dividing and Ruling the World? A Statistical Test of the Effects of
Colonialism on Postcolonial Civil Violence". In: _Social Forces_, pp. 785-817.
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../template/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
