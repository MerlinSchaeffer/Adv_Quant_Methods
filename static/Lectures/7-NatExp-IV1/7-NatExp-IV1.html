<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Natural Experiments &amp;    Instrument Variables (IV)</title>
    <meta charset="utf-8" />
    <meta name="author" content="Merlin Schaeffer  Department of Sociology" />
    <meta name="date" content="2022-09-16" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="../template/Merlin169.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Natural Experiments &amp; <br><br> Instrument Variables (IV)
]
.subtitle[
## Sometimes nature interferes
]
.author[
### Merlin Schaeffer<br> Department of Sociology
]
.date[
### 2022-09-16
]

---


# The goal of social science research

.font140[.center[.alert[Use data to discover patterns ("social facts" in Durkheim's terms), &lt;br&gt; and **the social mechanisms that bring them about**.]]]

&lt;img src="https://liu.se/-/media/istock-501261958.jpg?mw=1120&amp;mh=1120&amp;hash=DA8977CCE6A6E600AE80A40CFEE771C9" width="70%" style="display: block; margin: auto;" /&gt;

---
class: inverse middle
# Today's schedule

1. **Application 1**: Terrorist attacks and xenophobia. 

2. **Natural Experiments**
  + RCTs versus Natural Experiments

3. **Application 2:** Moving out of poor neighborhoods during early childhood.

4. **Intention to Treat (ITT)** Effects
  + RCTs versus ITTs

5. **Instrument Variables (IV)**
  - 3 IV requirements
  - First stage, reduced form, &amp; IV estimator
  - Why IV is LATE (local average treatment effect)

---
# Terrorism and xenophobia

.push-left[
&lt;img src="https://cdn.britannica.com/25/74225-050-7F97DCE4/second-jetliners-terrorists-al-Qaeda-smoke-billows-crash-Sept-11-2001.jpg" width="80%" style="display: block; margin: auto;" /&gt;


]

.push-right[
&lt;img src="https://cdn.britannica.com/33/129733-050-AF95D301/Smoke-flames-twin-towers-attacks-World-Trade-September-11-2001.jpg" width="77.5%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# Research question 1 of the day

.right-column[
&lt;img src="https://api.time.com/wp-content/uploads/2019/07/gettyimages-1064896696.jpg" width="60%" style="display: block; margin: auto;" /&gt;&lt;img src="https://www.brookings.edu/wp-content/uploads/2019/07/Denmark.jpg?w=1200&amp;h=630&amp;crop=1" width="60%" style="display: block; margin: auto;" /&gt;
]

--

.left-column[
.font130[
**What is the** 

**average causal effect**

**of terrorist attacks on xenophobia?**
]]

---
# We need an RCT!

.push-left[
&lt;img src="./img/randomization2.png" width="60%" style="display: block; margin: auto;" /&gt;

- If we *randomly* divide subjects into treatment and control groups: They come from the same underlying population. 
  &lt;br&gt; &lt;br&gt; `\(\rightarrow\)` Similar .alert[on average], *in every way*,&lt;br&gt; **including their `\(Y_{0}\)` **!
  &lt;br&gt; &lt;br&gt; `\(\rightarrow E[Y_{0i}|D=1] = E[Y_{0i}|D=0]\)`!
]

.push-right[

`$$\begin{equation}\begin{split} E &amp; [Y_{1i}|D=1] - E[Y_{0i}|D=0] \\  \\ &amp; = E[\color{red}{Y_{0i} + \kappa} |D=1] - E[Y_{0i}|D=0], \\ \\ &amp;= \color{red}{\kappa} + \underbrace{E[Y_{0i} |D=1] - E[Y_{0i}|D=0]}_{\underbrace{0}_{\text{(if randomization has worked)}}}, \\ \\ &amp; = \underbrace{\color{red}{\kappa}.}_{\text{The average causal effect}} \end{split}\end{equation}$$`
]

---
# But that's impossible and un-ethical!

.left-column[.center[
.alert[We cannot 

treat people with terrorism!]
]]

.right-column[
&lt;img src="7-NatExp-IV1_files/figure-html/DAG1-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse middle center
# Natural Experiments


---
class: clear
.left-column[
&lt;br&gt;

&lt;img src="https://jlegewie.com/files/joscha.jpg" width="100%" style="display: block; margin: auto;" /&gt;

### My friend Joscha 

### had an idea

]

.right-column[
&lt;img src="./img/Joscha1.png" width="60%" style="display: block; margin: auto;" /&gt;
]

---
# Natural experiments


.push-left[
**Natural experiment**: .alert[Random exposure] to treatment or control conditions are determined .alert[by nature] (or by other factors outside the control of researchers).

In comparison to a normal RCT, this allows for:
&gt; an experiment [...] on the grandest scale.

&gt; -- Snow (1856)
]

.push-right[.center[
The first natural experiment: &lt;br&gt;
The cause of Cholera]
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Snow-cholera-map-1.jpg/1920px-Snow-cholera-map-1.jpg" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Snow (1856)]]
]
---
# The 2002 Bali bombings

.left-column[
&lt;img src="https://www.iri.org/wp-content/uploads/2018/01/335017fda2a54fdc58700d83f73217c0.jpg?w=650" width="100%" style="display: block; margin: auto;" /&gt;&lt;img src="https://dynaimage.cdn.cnn.com/cnn/c_fill,g_auto,w_1200,h_675,ar_16:9/https%3A%2F%2Fcdn.cnn.com%2Fcnnnext%2Fdam%2Fassets%2F201213212550-indonesia-bali-bombings-arrest-intl-hnk-file-101602.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]

.right-column[
&lt;iframe src='https://en.wikipedia.org/wiki/2002_Bali_bombings' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
# The natural experiment

&lt;img src="./img/Joscha2.png" width="70%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Legewie (2013)]]

--

.push-left[
.alert[Assumption 1]: The European Social Survey is based on random sampling. .alert[The day of] `\(i\)`.alert['s interview is also random!]

- *Reachability bias*: Respondents who are easier to contact tend to be interviewed earlier during the survey period.
]

--

.push-right[
.alert[Assumption 2]: No other event or change over time had a causal effect on `\(Y_{i}\)`.
]

---
# Balance?

.left-column[
`$$E[Y_{0i}|D=1] = E[Y_{0i}|D=0]?$$`

&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.right-column[
&lt;img src="./img/Joscha3.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Legewie (2013)]]
]

---
# RCTs vs Natural experiments

.push-left[.content-box-red[
.font120[.center[**Internal validity**]]

With an RCT, we have control treatment assignment and thus know that the intervention `\(I\)` was randomly assigned.

&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]]

--

.push-left[.content-box-blue[
.font120[.center[**External validity**]]

With a natural experiment, we can study a real event `\(E\)` and not some artificial intervention `\(I\)`.
&lt;br&gt;&lt;br&gt;

&lt;img src="7-NatExp-IV1_files/figure-html/DAG2-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]]

---
# Natural experiments .font70[How to?!]

.left-column[.content-box-blue[
Analyzing a natural experiment does not necessarily involve much statistical sophistication; often simple OLS suffices.

*But finding one is as tough as finding truffles; you got to be lucky!*

.center[**_Are you such a &lt;br&gt;lucky truffle pig?_**]
]]

.right-column[
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Cochon_truffier.JPG" width="80%" style="display: block; margin: auto;" /&gt;
]

---
class: clear
# Learning goal 1 .font60[Terror attacks can increase xenophobia]

.right-column[
&lt;img src="./img/Joscha4.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Legewie (2013)]]
]

--

.left-column[.content-box-green[.center[
My friend Joscha &lt;br&gt; is a truffle pig ;)

Based on the idea that the day of a survey interview is random, he could estimate the causal effect of the Bali 2002 terror attack.

Do you want to learn what Joscha has to say about:

*Why was there an effect in Portugal, but not in the UK?* 

Read his article ;)
]]]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://www.latentview.com/wp-content/uploads/2016/04/LatentView-Turns-Ten-A-decade-of-data-science.jpg" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;
&lt;iframe src='exercise1.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse middle center
# Intention to Treat (ITT) Designs

---
# .font80[One of the largest RCTs in the social sciences]

.left-column[
&lt;img src="https://s3.amazonaws.com/uploads.thirdway.org/legacy/publishing/images/files/000/000/955/NEXT_-_Moving_to_Opportunity_COVER_Web.jpg?1422480199" width="55%" style="display: block; margin: auto;" /&gt;

&lt;img src="https://media.npr.org/assets/news/2010/12/06/chicago-176e8cb0fb2f87289bbda3bfd2b8b4f492fa572d-s1100-c50.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]

.right-column[
&lt;iframe src='https://en.wikipedia.org/wiki/Moving_to_Opportunity' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
layout: true
# Intention to treat `\(\neq\)` treatment

.left-column[
&lt;img src="https://i.ytimg.com/vi/h5MD2ptO998/maxresdefault.jpg" width="100%" style="display: block; margin: auto;" /&gt;

&lt;img src="7-NatExp-IV1_files/figure-html/DAG3-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

.right-column[
&lt;img src="./img/Chetty1.png" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Chetty, Hendren, and Katz (2016)]]
]

---

.right-column[
&lt;img src="./img/Chetty2.png" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Chetty, Hendren, and Katz (2016)]]

.content-box-green[.center[
Are these average causal effects of moving out of poor neighborhoods during childhood?
]]]

---

.right-column[
&lt;img src="./img/Chetty2.png" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Chetty, Hendren, and Katz (2016)]]

.content-box-blue[

.center[Since support for moving out of poor neighborhoods was randomly assigned by a lottery...]

`\(\rightarrow\)` The ITTs are average causal effects.

`\(\rightarrow\)` But they are average causal effects .alert[of being offered support] `\(\color{red}{Z}\)` .alert[, not of having moved to a better neighborhood] `\(\color{black}{D}\)`.alert[!]

]]

---
layout: false
# RCTs vs ITTs

.push-left[.content-box-red[
.font120[.center[**RCT**]]

`$$\begin{equation}\begin{split} &amp; |r_{I,D}| = 1 \\ &amp;\rightarrow I = D! \end{split}\end{equation}$$`

That is, the absolute correlation between intervention `\(I\)` and predictor of interest `\(D\)` is 1, making them practically the same thing.
&lt;br&gt;
&lt;br&gt;

&lt;img src="7-NatExp-IV1_files/figure-html/DAG4-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]]

--

.push-left[.content-box-blue[
.font120[.center[**ITT**]]

`$$\begin{equation}\begin{split} &amp; |r_{Z, D}| &lt; 1 \\ &amp;\rightarrow Z \neq D! \end{split}\end{equation}$$`

That is, the absolute correlation between intervention `\(Z\)` and predictor of interest `\(D\)` is smaller than 1, inducing some portion of random variation into `\(D\)`.


&lt;img src="7-NatExp-IV1_files/figure-html/DAG5-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]]

---
layout: false
class: inverse middle center
# .font50[Fortunately, the Intervention (i.e. intention to treat) can be used as an:]&lt;br&gt; Instrument Variable (IV)

---
layout: true
# Instrument Variables (IV)

.left-column[.content-box-red[
.center[**3 Requirements**]
1. *First stage*: Instrument has causal effect on outcome `\(Y_{i}\)`.

2. *Randomization*: Instrument is randomly assigned (RCT or natural experiment).

3. *Exclusion restriction*: Instrument affects outcome `\(Y_{i}\)` **_only_** through its effect on `\(D\)`.
  + In practice very difficult to test
]]

---
.right-column[
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---

.right-column[
&lt;img src="7-NatExp-IV1_files/figure-html/DAG6-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

.right-column[
&lt;img src="7-NatExp-IV1_files/figure-html/DAG7-1.png" width="100%" style="display: block; margin: auto;" /&gt;

`$$\underbrace{\kappa_{\text{Support}\rightarrow\text{Income}}}_{1624\text{ Dollar}} = \underbrace{\kappa_{\text{Support}\rightarrow\text{Moving}}}_{0.4766} \times \underbrace{\kappa_{\text{Moving}\rightarrow\text{Income}}}_{?}$$`

]

---

.right-column[
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /&gt;

`$$\begin{equation}\begin{split} &amp; \underbrace{\kappa_{\text{Support}\rightarrow\text{Income}}}_{1624\text{ Dollar}} = \underbrace{\kappa_{\text{Support}\rightarrow\text{Moving}}}_{0.4766} \times \underbrace{\kappa_{\text{Moving}\rightarrow\text{Income}}}_{?} \\ \\ &amp; \frac{\kappa_{\text{Support}\rightarrow\text{Income}}}{\kappa_{\text{Support}\rightarrow\text{Moving}}} = \underbrace{\kappa_{\text{Moving}\rightarrow\text{Income}}}_{?} \end{split}\end{equation}$$`
]
---
layout: false
# IV .font60[in general]

.push-left[
&lt;img src="7-NatExp-IV1_files/figure-html/DAG8-1.png" width="70%" style="display: block; margin: auto;" /&gt;

**First Stage:** `\(E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]; \text{call this }\phi.\)`

**Reduced Form:** `\(E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]; \text{call this }\rho.\)`

**IV Estimator:** `\(\lambda = \frac{\rho}{\phi} = \frac{E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]}{E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]}.\)`
]

--

.push-right[.content-box-blue[
.center[**The exclusion restriction matters!**&lt;br&gt;(but we can never test it)]
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-25-1.png" width="65%" style="display: block; margin: auto;" /&gt;

`$$\frac{1624}{0.4766} = \frac{\rho \color{red}{+ ?}}{\phi}\neq \lambda$$`
.center[.alert[
If the exclusion restriction does not hold, &lt;br&gt; we weigh-up other causal effects than `\(D\)` by `\(\frac{1}{\phi}\)`
]]]]

---
layout: false
# IV is LATE .font60[Local Average Treatment Effect]

.push-left[
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /&gt;

**First Stage:** `\(E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]; \text{call this }\phi.\)`

**Reduced Form:** `\(E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]; \text{call this }\rho.\)`

**IV Estimator of LATE:** `\(\lambda = \frac{\rho}{\phi} = \frac{E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]}{E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]} \color{red}{= E[Y_{1i}-Y_{0i}|\text{Complier}_{i}=1]}.\)`
]

.push-right[
&lt;img src="7-NatExp-IV1_files/figure-html/Tree1-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
layout: false
# IV is LATE .font60[Local Average Treatment Effect]

.push-left[
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /&gt;

**First Stage:** `\(E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]; \text{call this }\phi.\)`

**Reduced Form:** `\(E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]; \text{call this }\rho.\)`

**IV Estimator of LATE:** `\(\lambda = \frac{\rho}{\phi} = \frac{E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]}{E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]} \color{red}{= E[Y_{1i}-Y_{0i}|\text{Complier}_{i}=1]}.\)`
]

.push-right[
&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;" /&gt;

**IV is LATE**: Never- &amp; Always-taker don't respond to our intention to treat them. IV tells us nothing about them, but only about compliers.

**Monotonicity**: If there are defiers (&amp; compliers),&lt;br&gt; IV produces garbage.
]

---
class: clear
# Learning goal 2 .font60[Moving kids out of poor nbhs improves their adult lifes!]

.left-column[
`\(\lambda = \frac{\rho}{\phi} = \frac{E[Y_{i}|Z_{i}=1]-E[Y_{i}|Z_{i}=0]}{E[D_{i}|Z_{i}=1]-E[D_{i}|Z_{i}=0]}.\)`

&lt;img src="7-NatExp-IV1_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]
.right-column[
&lt;img src="./img/Chetty2.png" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Chetty, Hendren, and Katz (2016)]]
]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;


---
# Does Sesamy Street educate kids?

.left-column[
After this study by economists caused excitement, education researchers wanted to test it out.

They teamed up with 5 primary schools and had 240 kids participate in a study.

Teachers were told to *randomly* encourage some children to watch more sesame street.

.center[**Did the kids school performance increase?**]
]

.right-column[
&lt;img src="./img/Sesame.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---
class: middle clear

.left-column[
&lt;img src="https://www.latentview.com/wp-content/uploads/2016/04/LatentView-Turns-Ten-A-decade-of-data-science.jpg" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;
&lt;iframe src='exercise2.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse
# Today's general lessons

1. *Natural Experiment*: Sometimes nature or other forces randomly exposure people to treatment or control conditions. Compared to RCTs we have less control that exposure was truly random, but we can often study more interesting - real - events.

2. *Intention to Treat*: Some people do not comply with the experimental group we assign them to. In that case we estimate an average causal intention to treat effect, if we focus on the randomly assigned treatment alone.

3. *Instrument Variables (IV) Estimation*: Instrument variable regression allows us to recover the causal effect of the treatment (not the intention) in such situations.

4. *LATE (Local average treatment effect:* IV only estimates the treatment effect among compliers; we cannot know how people who did not comply to the intended treatment would have been affected by the treatment.

---
# References

.font80[
Chetty, R., N. Hendren, and L. F. Katz (2016). "The Effects of Exposure to Better Neighborhoods on
Children: New Evidence from the Moving to Opportunity Experiment". In: _The American Economic Review_,
pp. 855-902.

Legewie, J. (2013). "Terrorist Events and Attitudes toward Immigrants: A Natural Experiment". In:
_American Journal of Sociology_, pp. 1199-1245.

Snow, J. (1856). "On the Mode of Communication of Cholera". In: _Edinburgh Medical Journal_, pp.
668-670.
]

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../template/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
