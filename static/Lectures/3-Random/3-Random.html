<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Multiple Regression &amp;    Fundamentals of Causal Inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="Merlin Schaeffer  Department of Sociology" />
    <meta name="date" content="2023-07-06" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="../template/Merlin169.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Multiple Regression &amp; <br><br> Fundamentals of Causal Inference
]
.subtitle[
## Randomness and empirical sociology
]
.author[
### Merlin Schaeffer<br> Department of Sociology
]
.date[
### 2023-07-06
]

---


# Goal of empirical sociology

.font130[.center[Use data to .alert[discover patterns], &lt;br&gt; and the social mechanisms that bring them about.]]

&lt;img src="https://liu.se/-/media/istock-501261958.jpg?mw=1120&amp;mh=1120&amp;hash=DA8977CCE6A6E600AE80A40CFEE771C9" width="70%" style="display: block; margin: auto;" /&gt;
---
class: inverse
# Today's schedule

1. **Today's research question**: Education and trust in the political system.
  
2. **Randomness**
    + Samples
    + Weights

3. **Statistical inference**
    + Sampling error `\(\sigma\)`
    + Standard error `\(\hat{\sigma}\)`
    + Confidence intervals
    + Hypothesis tests
        + `\(H_0\)`
        + `\(t\)` and `\(p\)`-values

---
class: inverse
# Today's research question

.push-left[
&lt;iframe src='https://en.wikipedia.org/wiki/Political_efficacy' width='1200' height='550' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]


--

.push-right[
.center[**Do better-educated individuals _generally_ exhibit a stronger belief in the political system's fairness and government responsiveness?**

&lt;img src="https://media.istockphoto.com/vectors/politician-and-masks-vector-id1285284677?k=20&amp;m=1285284677&amp;s=612x612&amp;w=0&amp;h=pE_RkXIK8XaJBtuuHIsEbUo7pvtfu3yHEAQR5h8G-Jw=" width="90%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: [istockphoto.com](https://www.istockphoto.com/de)]]
]]

---
# Preparations

.panelset[
.panel[.panel-name[Packages for today's session]

```r
pacman::p_load(
  tidyverse, # Data manipulation,
  haven, # Handle labelled data.
  ggplot2, # beautiful figures,
  estimatr, # Regression for weighted data,
  modelr, # Turn results of lm() into a tibble,
  modelsummary) # regression tables with nice layout.
```
]

.panel[.panel-name[Get the ESS data]
.push-left[
Download the "ESS9e03_1.sav" data from Absalon. Place them into the folder for this course and where you have your R-project.
]
.push-right[

```r
# Read the ESS round 9 data
ESS &lt;- read_spss("../../../assets/ESS9e03_1.sav") %&gt;%
  filter(cntry == "DK") %&gt;% # Keep only the Danish data,
  # Keep only a minimum set of variables we need today,
  select(idno, pspwght, gndr, eduyrs, agea, 
         psppsgva, trstlgl, trstplc) %&gt;%
  drop_na() # Delete cases with missing values.
```
]]]

---
class: inverse middle center
# Randomness

---
# General patterns

.push-left[
All data we use are samples based on which we seek to draw general insights.
]

.push-right[
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/Generalization_process_using_trees.svg/1280px-Generalization_process_using_trees.svg.png" width="50%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: [Wikipedia](https://en.wikipedia.org/wiki/Generalization)]]
]

---
# Samples

.center[**Research is based on samples for two reasons:**]

--

.push-left[
(1) Populations are too large to study everyone.

&lt;img src="https://optimise2.assets-servd.host/best-fit/production/images/Roskilde-2022-Orange-Stage-Post-Malone-FlemmingBoJensen.jpeg?w=600&amp;h=338&amp;q=100&amp;auto=format&amp;fit=crop&amp;dm=1669804307&amp;s=b60a3165c822d00e54be5f3b64a69a7d" width="90%" style="display: block; margin: auto;" /&gt;
]

--

.push-right[
(2) Even if we have (e.g., register) data on everyone, we are interested in .font120[.alert[general patterns and social mechanisms]]:
  - There is less poverty in socialist countries?
  - Do better educated have more political efficacy?
  - Does anomie make people suicidal?
    
    
  `\(\rightarrow\)` We generally want to know these things. .backgrnote[
  (i.e. not only for the current population of Denmark, or for the currently existing countries in the world.)]
  
  .content-box-red[
  `\(\rightarrow\)` We thus treat any data as a sample of an unobservable "super population".
]]

---
# Convenience samples

.left-column[
Samples should be representative: accurately reflect the (unobservable super) population.

.content-box-green[
If you snowball sample starting with your best friend, what biases will that result in? Who would be underrepresented?
]]

.right-column[
&lt;img src="img/Convenience_Sample.png" width="100%" style="display: block; margin: auto;" /&gt;
]
---
# Random samples!

.push-left[.content-box-red[
.center[**We rely on randomness to&lt;br&gt; draw _unbiased_ conclusions**]

Two types of conclusions:
  1. Random sample `\(\rightarrow\)` Population
  2. Random `\(x \rightarrow\)` causal effect of `\(x\)` on `\(y\)`
]]

.push-right[
&lt;img src="https://m.media-amazon.com/images/I/71jm22A7m9L._AC_SL1200_.jpg" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[
Similar to certain mirrors,&lt;br&gt; data often lead to biased insights.]]
]

---
# Why randomness?

.push-left[
.content-box-green[
Why do many games have a random element?
]

&lt;img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Monopoly_board_on_white_bg.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

--

.push-right[
&lt;img src="https://lotterylab.s3.amazonaws.com/summernoteimages/606ffa6b3468c.gif" width="80%" style="display: block; margin: auto;" /&gt;

1. Thrill: No one knows the outcome.

2. .font120[.alert[Fairness!]] Known and similar probabilities for all players, *regardless of who they are*.

]

---
layout: true
# Random samples!

.push-left[

&lt;img src="https://lotterylab.s3.amazonaws.com/summernoteimages/606ffa6b3468c.gif" width="60%" style="display: block; margin: auto;" /&gt;

&lt;br&gt;
&lt;br&gt;
Random samples are "fair": &lt;br&gt;
Everyone in the (unobservable super) population has the same probability to be part of the sample, .alert[regardless of who they are]!

`\(\rightarrow\)` No group can be forgotten.
]

---

.push-right[
&lt;img src="https://www.kuechengoetter.de/uploads/media/630x630/02/28602-suppentopf-mit-nudeln-und-haehnchen.jpg?v=1-0" width="50%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[
Random sampling is the equivalent of &lt;br&gt; giving the soup a proper stir before we taste it ;).]]
]

---
layout: false
class: inverse middle center

Nice talk man.

**But we all know that it's not random who participates in a study**

&lt;br&gt;
&lt;img src="https://bloximages.chicago2.vip.townnews.com/buffalonews.com/content/tncms/assets/v3/editorial/1/dc/1dc9a2da-fc52-11eb-9244-2b611ea83ea0/61169b5e36ff5.image.jpg" width="50%" style="display: block; margin: auto;" /&gt;


---
# Weights

.push-left[
- A *weight* tells you the probability that a case should be in the sample. .backgrnote[
In a true random sample, each case of the population has an equal probability to be sampled. Thus each sampled case has a weight of 1.]
-  Some groups tend to be over\under-sampled. Post-stratification weights try to counterbalance this.
&lt;br&gt;

.content-box-green[.center[
Why would survey researchers assign lower weights to older people?
]]]

.push-right[
.panelset[
.panel[.panel-name[Plot]
&lt;img src="3-Random_files/figure-html/weights_fig-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Code]

```r
ggplot(data = ESS, 
       mapping = aes(y = pspwght, x = agea)) +
  geom_point(alpha = 1/3) +
  geom_smooth(method = "lm", se = FALSE) + # OLS regression line.
  labs(y = "Post-stratification weight", x = "Age in years",
       caption = "Danish European Social Survey 2018") +
  theme_minimal()
```
]]]

---
# How weights work

- Statistically, we use weights by multiplication. 

.push-left[
- Consider an example of a patriarchal society where the weight of men's votes is twice that of women's. In this context, we have a ballot on the topic of women's driving rights.

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; i &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Gender &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Vote &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Voted yes &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Weight &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; man &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; man &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; woman &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; woman &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; woman &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



.center[
.content-box-green[
What is the patriarchy-weighted percent &lt;br&gt; of "Yes"-votes?
]
]
]

--

.push-right[
- Three equivalent ways to calculate the percent of patriarchy-weighted "Yes"-votes:

.panelset[
.panel[.panel-name[1.]

```r
((0*2 + 1*2 + 1 + 1 + 0) / 7) * 100 # (1)
# [1] 57.1
```
]
.panel[.panel-name[2.]

```r
(sum(`Voted yes` * Weight) / sum(Weight)) * 100 # (2)
# [1] 57.1
```
]
.panel[.panel-name[3.]

```r
weighted.mean(x = `Voted yes`, w = Weight) * 100 # (3)
# [1] 57.1
```
]]]

---
# Weights can be amazing!

.push-left[
&lt;img src="img/Wang1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.push-right[
&lt;img src="img/Wang2.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---
# Using weights

.left-column[
- Most R commands have a weights argument.

- For OLS regression use: `estimatr::lm_robust()`. 
.backgrnote[
Using weights results in heteroscedastic residuals, which violates an OLS assumption. lm_robust() corrects for that.]
]

.right-column[
.panelset[


.panel[.panel-name[Example]
&lt;img src="3-Random_files/figure-html/ols_fig-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[OLS Regression]
&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Unweighted &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Weighted &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.199 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.378 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt; eduyrs &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; 0.039 &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; 0.025 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1511 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1511 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.026 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.010 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]
.panel[.panel-name[Code]

```r
# Prepare the data
ESS &lt;- ESS %&gt;% mutate(
    psppsgva = zap_labels(psppsgva), # Make numeric
    eduyrs = case_when( # Censor years of education at 9 &amp; 21 years.
        eduyrs &gt; 21 ~ 21,
        eduyrs &lt; 9 ~ 9,
        TRUE ~ as.numeric(eduyrs)),
    gndr = as_factor(gndr)) # Make factor

# Estimate the models
mod1 &lt;- lm_robust(psppsgva ~ eduyrs, data = ESS) # Unweighted

mod2 &lt;- lm_robust(psppsgva ~ eduyrs, data = ESS, # Weighted
*                 weights = pspwght)

# Nicely-formatted regression table
modelsummary(list("Unweighted" = mod1, "Weighted" = mod2),
             statistic = NULL, # Don't report stat. inference
             gof_map = c("nobs", "r.squared")) # Only 2 models fit stats
```
]]]

---
class: inverse middle center

.push-left[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img src="https://www.business2community.com/wp-content/uploads/2013/03/Question1.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

.push-left[
&lt;br&gt;
OK, great: Randomness prohibits systematic biases and thus enables us to draw representative samples. If randomization has partly failed, we use post-stratification weights to counterbalance.

**But doesn't this mean, I have randomness in my data** &lt;br&gt; (e.g., just by chance too many vegetarians or so) &lt;br&gt; **and thus still biased data?**
]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://cdn.dribbble.com/users/10549/screenshots/9916149/media/a9dbfea8e23e5b8e23db142528c3bc9f.png?compress=1&amp;resize=1200x900&amp;vertical=top" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;

&lt;iframe src='exercise1.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: inverse middle center
# Statistical inference

---
# Sampling error `\(\sigma\)` .font60[(aka sampling variability)]

.push-left[
**Goal**: Gain unbiased insights from data.

.center[
`\(\downarrow\)` 
]

**Solution**: *Random sampling* prohibits systematic biases, and *weighting* helps to alleviate partly failed randomization.

.center[
`\(\downarrow\)` 
]

**Problem**: Random samples contain unsystematic *sampling error*.

.center[
`\(\downarrow\)` 
]

**Question**: With how much confidence can we *infer* (i.e., generalize) from our random sample to the unobserved (super) population? Could the patterns in our data just be the result of happenstance (i.e., sampling error)?
]

.push-right[
&lt;img src="https://ecampusontario.pressbooks.pub/app/uploads/sites/376/2019/02/70-959x1024.png" width="60%" style="display: block; margin: auto;" /&gt;
.backgrnote[.center[Random sampling ensures validity (i.e. unbiased), but it results in some unreliability (i.e. sampling error). The question is: How unreliable are the data?]]
]
---
# Sampling error `\(\sigma\)` .font60[(aka sampling variability)]

.push-left[
- **Let's assume, the Danish ESS with it's 1511 respondents was our (unobservable super) population of interest.** .backgrnote[Thus no weights in this example ;)]

- That would mean, we can *calculate* the true OLS regression line (in blue): `\(\beta = 0.039\)`.
]

.push-right[
&lt;img src="3-Random_files/figure-html/true_ols-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
# Sampling error `\(\sigma\)` .font60[(aka sampling variability)]

.push-left[
- **Lets assume, the Danish ESS with it's 1511 respondents was our (unobservable super) population of interest.** .backgrnote[I thus don't use weights in this example ;)]

- That would mean, we can *calculate* the true OLS regression line (in blue): `\(\beta = 0.039\)`.

- Now I take a random sample of 50 persons.


```r
set.seed(1261990) # Random seed, to reproduce result.
ESS_sample &lt;- ESS %&gt;% sample_n(50) # Draw the sample.
```
]

.push-right[
&lt;img src="3-Random_files/figure-html/sample1_ols1-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
# Sampling error `\(\sigma\)` .font60[(aka sampling variability)]

.push-left[
- **Lets assume, the Danish ESS with it's 1511 respondents was our (unobservable super) population of interest.** .backgrnote[I thus don't use weights in this example ;)]

- That would mean, we can *calculate* the true OLS regression line (in blue): `\(\beta = 0.039\)`.

- Now I take a random sample of 50 persons.


```r
set.seed(1261990) # Random seed, to reproduce result.
ESS_sample &lt;- ESS %&gt;% sample_n(50) # Draw the sample.
```

- ... and *estimate* an OLS regression line based on that 50-person sample (in red): `\(\hat{\beta} = 0.042\)`.
]

.push-right[
&lt;img src="3-Random_files/figure-html/sample1_ols2-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
# Sampling error `\(\sigma\)` .font60[(aka sampling variability)]

.push-left[
- **Lets assume, the Danish ESS with it's 1511 respondents was our (unobservable super) population of interest.** .backgrnote[I thus don't use weights in this example ;)]

- That would mean, we can *calculate* the true OLS regression line (in blue): `\(\beta = 0.039\)`

- .alert[Let's take another random sample of 50 persons.]


```r
ESS_sample_2 &lt;- ESS %&gt;% sample_n(50) # Draw the sample.
```

- ... and *estimate* an OLS regression line based on that 50-person sample (in red): `\(\hat{\beta} = 0.012\)`.
]

.push-right[
&lt;img src="3-Random_files/figure-html/sample1_ols3-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

---
# Let's do this 1000 times!

.panelset[
.panel[.panel-name[Code for the Nerds]

```r
Samples &lt;- bind_rows(
  ESS_sample, ESS_sample_2, 
  .id = "sample_nr") %&gt;%
  mutate(sample_nr = as.numeric(sample_nr))

# Add more samples to the first two in a loop.
for (draw in 3:1000) { 
  Samples &lt;- bind_rows(
    Samples,
    ESS %&gt;% 
      sample_n(50) %&gt;% 
      mutate(sample_nr = draw))
}
```
]
.panel[.panel-name[Animated figure]
&lt;img src="3-Random_files/figure-html/sample1000_ols3-1.gif" width="60%" style="display: block; margin: auto;" /&gt;
]

.panel[.panel-name[Histogram]
&lt;img src="3-Random_files/figure-html/sample1000_ols4-1.png" width="60%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Normal distribution]
.left-column[
.center[We know the area under the Normal distribution!]

- .alert["Critical values"]: 
  + `\(\sigma = 1.65\)` for 90%
  + `\(\sigma = 1.96\)` for 95%

.font90[

```r
# If assuming the Normal distribution
# is correct, then 95% of the 
# estimates of beta will lie in 
# the interval:
mean(beta_hat) - 1.96 * sd(beta_hat)
# [1] -0.0337
mean(beta_hat) + 1.96 * sd(beta_hat)
# [1] 0.107
```
]]

.right-column[
&lt;img src="img/68-90-99.png" width="80%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* Veaux, Velleman, and Bock (2021)]]
]]
.panel[.panel-name[*t*-distribution]
.left-column[
.center[With small samples things are a bit more complex!]

Critical values depend on the degrees of freedom (df): Sample size `\(n\)` minus the number of estimated parameters.

.font80[

```r
# Critical value for 95%,
# with df = 50 - 5:
(crit_val &lt;- qt(p = 0.975, df = 48))
# [1] 2.01
# 95% of the estimates of beta 
# will lie in the interval
mean(beta_hat) - crit_val * sd(beta_hat)
# [1] -0.0355
mean(beta_hat) + crit_val * sd(beta_hat)
# [1] 0.109
```
]]

.right-column[
&lt;img src="img/t-dist.png" width="65%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source:* [Wikipedia](https://en.wikipedia.org/wiki/Student%27s_t-distribution)]]
]]

]


---
class: inverse middle center

.push-left[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img src="https://www.business2community.com/wp-content/uploads/2013/03/Question1.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

.push-left[
&lt;br&gt;
But if I can't sample the whole (unobservable super) population, then I surely can't draw thousands of 50 person samples.
]

---
class: clear
layout: true
# The standard error `\(\hat{\sigma}\)` .font70[(i.e., estimated sampling error)]

.left-column[
True sampling error from our repeated samples:


```r
sd(beta_hat)
# [1] 0.0359
```

&lt;img src="3-Random_files/figure-html/unnamed-chunk-32-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

---

.right-column[
.push-left[
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Carl_Friedrich_Gauss_1840_by_Jensen.jpg/440px-Carl_Friedrich_Gauss_1840_by_Jensen.jpg" width="60%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[Carl Friedrich Gauss (1777-1855)]]
]
.push-right[
Thanks to mathematician [Carl Friedrich Gauss](https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss), we can *estimate* the sampling error of most statistics based on a single sample!
]]

---

.right-column[
.push-left[
Estimated sampling error based on our initial 50-person sample using Gauss' formula for the standard error of an OLS regression coefficient: `$$\hat{\sigma}(\beta)=\sqrt{\frac{1}{n-2}\frac{\text{SD}(e)}{\text{SD}(x)}}$$`
]
.push-right[

```r
mod &lt;- lm_robust( # OLS regression
  psppsgva ~ eduyrs, 
* se_type = "classical", # Gauss
* data = ESS_sample)

modelsummary( # Regression table
  list("Pol. efficacy" = mod),
  gof_map = c("nobs", "r.squared"))
```

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Pol. efficacy &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1.965 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.530) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; eduyrs &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.042 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.036) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 50 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.027 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]]

---

.right-column[
.push-left[
Estimated sampling error based on our second 50-person sample using Gauss' formula for the standard error of an OLS regression coefficient, `\(\hat{\sigma}(\beta)=\sqrt{\frac{1}{n-2}\frac{\text{SD}(e)}{\text{SD}(x)}}\)`
]
.push-right[

```r
mod2 &lt;- lm_robust( # OLS regression
  psppsgva ~ eduyrs, 
* se_type = "classical", # Gauss
* data = ESS_sample_2)

modelsummary( # Regression table
  list("Pol. efficacy" = mod2),
  gof_map = c("nobs", "r.squared"))
```

&lt;table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Pol. efficacy &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2.624 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.634) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; eduyrs &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.012 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.042) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 50 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.002 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]]

---
layout: false
# 95% Confidence intervals 

.left-column[
.content-box-green[
If we continuously drew random samples and estimated the interval:

`\(\hat{\beta} \pm \text{Critical value} * \hat{\sigma}\)`, 

how many of these would contain `\(\beta\)`?
]
]
.right-column[
&lt;iframe src='https://seeing-theory.brown.edu/frequentist-inference/index.html#section2' width='1200' height='550' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: clear
# Visualizing uncertainty .font70[95% CIs in scatterplots]

.panelset[
.panel[.panel-name[Code]

```r
ggplot(data = ESS_sample, aes(y = psppsgva, x = eduyrs)) +
  geom_jitter(alpha = 1/3, width = 0.1, height = 0.1) +
  geom_smooth(method = "lm", # OLS
              level = 0.95, # 95% CI
              color = "#901A1E") + 
  ylim(1, 5) +
  labs(y = "The political system allows people \n to have a say in what government does",
       x = "Years of education") +
  theme_minimal()
```
]
.panel[.panel-name[Plot]
.push-left[
&lt;img src="3-Random_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&lt;img src="3-Random_files/figure-html/unnamed-chunk-37-1.gif" width="90%" style="display: block; margin: auto;" /&gt;
]]]

---
layout: true
# Hypotheses tests .font60[The Null Hypothesis]

.left-column[
&lt;br&gt;

&lt;img src="https://upload.wikimedia.org/wikipedia/commons/5/59/The_Debate_Of_Socrates_And_Aspasia.jpg" width="100%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[The debate of Socrates and Aspasia]]

Doing research is basically like having a debate with an opponent who does not believe your argument.
]

---

---

.right-column[
&lt;br&gt;

.push-left[
&lt;img src="https://www.convinceandconvert.com/wp-content/uploads/2014/07/bigstock-Portrait-of-a-senior-man-skept-12585803.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&gt; More educated people read more news and thus know about all the corruption. 

&gt; Certainly, their believe in political efficacy is no different!

&gt; That you find otherwise in your data is just a chance finding.

]]

---

.right-column[
&lt;br&gt;

.push-left[
&lt;img src="https://www.convinceandconvert.com/wp-content/uploads/2014/07/bigstock-Portrait-of-a-senior-man-skept-12585803.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

.push-right[
&gt; More educated people read more news and thus know about all the corruption. 

&gt; Certainly, their believe in political efficacy is no different!

&gt; That you find otherwise in your data is just a chance finding.

`\(\rightarrow \underbrace{H_{0}:}_{\text{Aka }H_{\text{0pponent  }} ;)}\beta_{\text{Years of education}} = 0\)`
]]

---
layout: false
# The weird logic .font60[of hypotheses tests]

.push-left[
- `\(H_{0}:\)` Today, the sun is shining!

- What is the probability that I randomly observe 5 kids, all of whom go to school with an umbrella, under the assumption: `\(H_{0} = \text{TRUE}\)`?
  + `\(P(\text{5 Umbrella kids}|\text{Sunshine})\)`


- If `\(P(\text{5 Umbrella kids}|\text{Sunshine}) &lt; 5\%\)`,&lt;br&gt; I rather believe the sun is not shining!
]

.push-right[
&lt;img src="https://i.pinimg.com/originals/20/a6/33/20a633fe23ae51592ee7919e983b41f9.jpg" width="90%" style="display: block; margin: auto;" /&gt;
]

---
layout: false
# The weird logic .font60[of hypotheses tests]

.push-left[
- `\(H_{0}:\)` Today, the sun is shining!

- What is the probability that I randomly observe 5 kids, all of whom go to school with an umbrella, under the assumption: `\(H_{0} = \text{TRUE}\)`?
  + `\(P(\text{5 Umbrella kids}|\text{Sunshine})\)`


- If `\(P(\text{5 Umbrella kids}|\text{Sunshine}) &lt; 5\%\)`,&lt;br&gt; I rather believe the sun is not shining!

.content-box-green[.center[
Can you come up with another example?
]]
]

.push-right[
&lt;img src="https://i.pinimg.com/originals/20/a6/33/20a633fe23ae51592ee7919e983b41f9.jpg" width="90%" style="display: block; margin: auto;" /&gt;
]

---
# Put into practice

.left-column[
&lt;br&gt;

&lt;img src="https://www.convinceandconvert.com/wp-content/uploads/2014/07/bigstock-Portrait-of-a-senior-man-skept-12585803.jpg" width="60%" style="display: block; margin: auto;" /&gt;

`\(\underbrace{H_{0}:}_{\text{Aka }H_{\text{0pponent  }} ;)}\beta_{\text{Years of education}} = 0\)`
]

--

.right-column[
.panelset[
.panel[.panel-name[Regression model]

```r
ols &lt;- lm_robust(psppsgva ~ eduyrs, data = ESS_sample)
summary(ols)
# 
# Call:
# lm_robust(formula = psppsgva ~ eduyrs, data = ESS_sample)
# 
# Standard error type:  HC2 
# 
# Coefficients:
#             Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper DF
# (Intercept)    1.965      0.635   3.096  0.00327   0.6889    3.242 48
# eduyrs         0.042      0.043   0.976  0.33405  -0.0445    0.128 48
# 
# Multiple R-squared:  0.0274 ,	Adjusted R-squared:  0.00713 
# F-statistic: 0.952 on 1 and 48 DF,  p-value: 0.334
```
]

.panel[.panel-name[Hypothesis test]
&lt;img src="3-Random_files/figure-html/density1-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[t- and p-value]
.push-left[
- `\(t=\frac{\hat{\beta}}{\sigma}\)`: How many `\(\sigma\)`'s is `\(\hat{\beta}\)` away from `\(H_{0}:\beta=0\)`?


- `\(p\)`-value: The area outside `\(0 \pm t\)`
  + `\(P(\hat{\beta}|\beta=0)\)`: The probability that we observe `\(\hat{\beta}\)`, although `\(\beta=0\)` in reality.
]
.push-right[
&lt;img src="3-Random_files/figure-html/density2-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]]]
]

---
# Learning goal achieved!

.left-column[
.center[**Do better-educated individuals _generally_ exhibit a stronger belief in the political system's fairness and government responsiveness?**

&lt;img src="https://media.istockphoto.com/vectors/politician-and-masks-vector-id1285284677?k=20&amp;m=1285284677&amp;s=612x612&amp;w=0&amp;h=pE_RkXIK8XaJBtuuHIsEbUo7pvtfu3yHEAQR5h8G-Jw=" width="90%" style="display: block; margin: auto;" /&gt;
.center[.backgrnote[*Source*: [istockphoto.com](https://www.istockphoto.com/de)]]
]]

.right-column[
.panelset[
.panel[.panel-name[Regression table]

```r
ols_goal &lt;- lm_robust(psppsgva ~ eduyrs, weights = pspwght, data = ESS)
summary(ols_goal, include.ci = FALSE, digits = 3)
# 
# Call:
# lm_robust(formula = psppsgva ~ eduyrs, data = ESS, weights = pspwght)
# 
# Weighted, Standard error type:  HC2 
# 
# Coefficients:
#             Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper   DF
# (Intercept)   2.3781    0.11366   20.92 1.47e-85  2.15511   2.6010 1509
# eduyrs        0.0246    0.00771    3.19 1.47e-03  0.00944   0.0397 1509
# 
# Multiple R-squared:  0.00963 ,	Adjusted R-squared:  0.00897 
# F-statistic: 10.2 on 1 and 1509 DF,  p-value: 0.00147
```
]
.panel[.panel-name[Scatterplot]
&lt;img src="3-Random_files/figure-html/goal-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]]]

---
class: inverse middle center
# Break

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;

---
class: middle clear

.left-column[
&lt;img src="https://www.latentview.com/wp-content/uploads/2016/04/LatentView-Turns-Ten-A-decade-of-data-science.jpg" width="100%" style="display: block; margin: auto;" /&gt;

&lt;iframe src='https://www.online-timer.net/' width='400' height='385' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

.right-column[
&lt;br&gt;
&lt;iframe src='exercise2.html' width='1000' height='600' frameborder='0' scrolling='yes'&gt;&lt;/iframe&gt;
]

---
class: inverse
# Today's general lessons
- Randomness prevents systematic bias, ensuring that random samples are representative unless the sample size (n) is very small.
- In cases where random sampling is not feasible, we utilize post-stratification weights to counterbalance bias.
- Random sampling introduces sampling error, which reduces reliability.
- These errors follow a normal or `\(t\)`-distribution, depending on the sample size.
- We can estimate the sampling error from our data using the standard error `\((\hat{\sigma})\)`.
- By leveraging our knowledge of the normal and `\(t\)`-distributions, we can estimate 95% confidence intervals to express uncertainty and conduct hypothesis tests to determine the likelihood of our findings being due to chance.
- Hypothesis tests assess the null hypothesis ($H_0$), typically the opposite of what is being demonstrated.
- They evaluate the probability ($p$-value) of observing the data when `\(H_0\)` is true.
- The `\(t\)`-value represents the number of standard errors by which the estimate (e.g., `\(\beta\)`) deviates from the null hypothesis (usually 0).
- The `\(p\)`-value indicates the area under the sampling distribution outside of `\(H_0 \pm t\)`. Conventionally, the `\(p\)`-value should be `\(&lt;0.05\)`.

---
class: inverse
# Today's (important) R functions
- `geom_smooth(method = "lm")`: Add OLS lines to scatter plots.
- Most R functions have a `weights` argument.
- `modelsummary()` allows you to design your regression tables in various ways.
---
# References

.font80[
Veaux, D., Velleman, and Bock (2021). _Stats: Data and Models, Global Edition_. Pearson Higher Ed.
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../template/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
